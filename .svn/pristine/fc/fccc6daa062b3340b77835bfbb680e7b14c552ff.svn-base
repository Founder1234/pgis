
/*
 * aciTree jQuery Plugin v4.5.0-rc.10
 * http://acoderinsights.ro
 *
 * Copyright (c) 2015 Dragos Ursu
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Require jQuery Library >= v1.9.0 http://jquery.com
 * + aciPlugin >= v1.5.1 https://github.com/dragosu/jquery-aciPlugin
 */

// DOM
aciPluginClass.plugins.aciTree_dom={container:function(n){var r=n.lastChild;return r&&"UL"==r.nodeName?r:null},firstChild:function(n,r){var i=this.container(n);if(i){var l=i.firstChild;if(r)for(;l&&!r.call(this,l);)l=l.nextSibling;return l}return null},lastChild:function(n,r){var i=this.container(n);if(i){var l=i.lastChild;if(r)for(;l&&!r.call(this,l);)l=l.previousSibling;return l}return null},prev:function(n,r){var i=n.previousSibling;if(r)for(;i&&!r.call(this,i);)i=i.previousSibling;return i},next:function(n,r){var i=n.nextSibling;if(r)for(;i&&!r.call(this,i);)i=i.nextSibling;return i},prevAll:function(n,r){for(var i,l,t,e,s,a;;){if(i=this.prev(n)){if(r&&(e=r.call(this,i),null===e)){n=i;continue}if(l=this.lastChild(i),!l){if(!r||e)return i;n=i;continue}if(r&&null===r.call(this,l)){n=l;continue}for(s=!1;t=this.lastChild(l);)if(l=t,r&&(e=r.call(this,l),null===e)){n=l,s=!0;break}if(s)continue;if(!r)return l;if(e=r.call(this,l))return l;if(null!==e){n=l;continue}}if(a=this.parent(n),!a)return null;if(!r)return a;if(e=r.call(this,a))return a;n=a}return null},nextAll:function(n,r){for(var i,l,t,e,s;;){if(i=this.firstChild(n)){if(!r)return i;if(l=r.call(this,i))return i;if(n=i,null!==l)continue}for(;;){if(t=this.next(n)){if(r){if(l=r.call(this,t))return t;if(n=t,null!==l)break;continue}return t}for(e=n,s=null;e=this.parent(e);)if(t=this.next(e)){if(r){if(l=r.call(this,t))return t;n=t,s=null!==l?!0:!1;break}return t}if(null===s)return null;if(s)break}}return null},first:function(n,r){var i=this.container(n);if(i){var l=i.firstChild;if(l)return r&&!r.call(this,l)?this.nextAll(l,r):l}return null},last:function(n,r){var i=this.container(n);if(i){var l=i.lastChild;if(l){if(r&&null===r.call(this,l))return this.prevAll(l,r);for(var t;t=this.lastChild(l);)l=t;return r&&!r.call(this,l)?this.prevAll(l,r):l}}return null},children:function(n,r,i){var l,t,e,s=[],a=[],f=this.firstChild(n);if(f)for(;;){e=!1;do if(i){if(l=i.call(this,f),l&&s.push(f),r&&null!==l&&(t=this.firstChild(f))){a.push(f),f=t,e=!0;break}}else if(s.push(f),r&&(t=this.firstChild(f))){a.push(f),f=t,e=!0;break}while(f=f.nextSibling);if(!e){for(;(f=a.pop())&&!(f=f.nextSibling););if(!f)break}}return s},childrenTill:function(n,r){var i,l,t,e=[],s=n.firstChild;if(s)for(;;){t=!1;do{if(i=r.call(this,s))return s;if(null===i)return null;if(l=s.firstChild){e.push(s),s=l,t=!0;break}}while(s=s.nextSibling);if(!t){for(;(s=e.pop())&&!(s=s.nextSibling););if(!s)break}}return null},childrenByClass:function(n,r){if(n.getElementsByClassName){var i=n.getElementsByClassName(r instanceof Array?r.join(" "):r);return i?i[0]:null}return this.childrenTill(n,function(n){return this.hasClass(n,r)})},parent:function(n){var r=n.parentNode.parentNode;return r&&"LI"==r.nodeName?r:null},parentFrom:function(n){for(;"LI"!=n.nodeName;)if(n=n.parentNode,!n)return null;return n},parentTill:function(n,r){for(var i;n=n.parentNode;){if(i=r.call(this,n))return n;if(null===i)return null}return null},parentByClass:function(n,r){return this.parentTill(n,function(n){return this.hasClass(n,r)})},hasClass:function(n,r,i){var l=" "+n.className+" ";if(i instanceof Array){for(var t=0;t<i.length;t++)if(-1!=l.indexOf(" "+i[t]+" "))return!1}else if(i&&-1!=l.indexOf(" "+i+" "))return!1;if(r instanceof Array){for(var t=0;t<r.length;t++)if(-1==l.indexOf(" "+r[t]+" "))return!1}else if(r&&-1==l.indexOf(" "+r+" "))return!1;return!0},withClass:function(n,r,i){for(var l=[],t=0;t<n.length;t++)this.hasClass(n[t],r,i)&&l.push(n[t]);return l},hasAnyClass:function(n,r,i){var l=" "+n.className+" ";if(i instanceof Array){for(var t=0;t<i.length;t++)if(-1!=l.indexOf(" "+i[t]+" "))return!1}else if(i&&-1!=l.indexOf(" "+i+" "))return!1;if(r instanceof Array){for(var t=0;t<r.length;t++)if(-1!=l.indexOf(" "+r[t]+" "))return!0}else if(r&&-1!=l.indexOf(" "+r+" "))return!0;return!1},withAnyClass:function(n,r,i){for(var l=[],t=0;t<n.length;t++)this.hasAnyClass(n[t],r,i)&&l.push(n[t]);return l},addClass:function(n,r){var i=" "+n.className+" ",l="";if(r instanceof Array)for(var t=0;t<r.length;t++)-1==i.indexOf(" "+r[t]+" ")&&(l+=" "+r[t]);else-1==i.indexOf(" "+r+" ")&&(l+=" "+r);return l?(n.className=n.className+l,!0):!1},addListClass:function(n,r,i){for(var l=0;l<n.length;l++)this.addClass(n[l],r),i&&i.call(this,n[l])},removeClass:function(n,r){var i=" "+n.className+" ";if(r instanceof Array)for(var l=0;l<r.length;l++)i=i.replace(" "+r[l]+" "," ");else i=i.replace(" "+r+" "," ");return i=i.substr(1,i.length-2),n.className!=i?(n.className=i,!0):!1},removeListClass:function(n,r,i){for(var l=0;l<n.length;l++)this.removeClass(n[l],r),i&&i.call(this,n[l])},toggleClass:function(n,r,i){return i?this.addClass(n,r):this.removeClass(n,r)},toggleListClass:function(n,r,i,l){for(var t=0;t<n.length;t++)this.toggleClass(n[t],r,i),l&&l.call(this,n[t])},addRemoveClass:function(n,r,i){var l=" "+n.className+" ";if(i)if(i instanceof Array)for(var t=0;t<i.length;t++)l=l.replace(" "+i[t]+" "," ");else l=l.replace(" "+i+" "," ");if(r){var e="";if(r instanceof Array)for(var t=0;t<r.length;t++)-1==l.indexOf(" "+r[t]+" ")&&(e+=r[t]+" ");else-1==l.indexOf(" "+r+" ")&&(e+=r+" ");l+=e}return l=l.substr(1,l.length-2),n.className!=l?(n.className=l,!0):!1},addRemoveListClass:function(n,r,i,l){for(var t=0;t<n.length;t++)this.addRemoveClass(n[t],r,i),l&&l.call(this,n[t])}};

// core
!function(i,e,t){var s={ajax:{url:null,dataType:"json"},dataSource:null,rootData:null,queue:{async:4,interval:50,delay:20},loaderDelay:500,expand:!1,collapse:!1,unique:!1,empty:!1,show:{props:{height:"show"},duration:"medium",easing:"linear"},animateRoot:!0,hide:{props:{height:"hide"},duration:"medium",easing:"linear"},view:{duration:"medium",easing:"linear"},ajaxHook:function(i,e){e.url+=i?this.getId(i):""},itemHook:function(i,e,t,s){},serialize:function(i,e,t){return"object"==typeof e?t:"|"+t}},n={__extend:function(){i.extend(this._instance,{queue:new this._queue(this,this._instance.options.queue)}),i.extend(this._private,{locked:!1,itemClone:{},loaderHide:null,loaderInterval:null,delayBusy:0})},init:function(i){if(i=this._options(i),this.wasInit())return this._trigger(null,"wasinit",i),void this._fail(null,i);if(this.isLocked())return this._trigger(null,"locked",i),void this._fail(null,i);if(!this._trigger(null,"beforeinit",i))return this._trigger(null,"initfail",i),void this._fail(null,i);this._private.locked=!0,this._instance.jQuery.addClass("aciTree"+this._instance.index).attr("role","tree").on("click"+this._instance.nameSpace,".aciTreeButton",this.proxy(function(i){var e=this.itemFrom(i.target);this.isBusy(e)||this.toggle(e,{collapse:this._instance.options.collapse,expand:this._instance.options.expand,unique:this._instance.options.unique})})).on("mouseenter"+this._instance.nameSpace+" mouseleave"+this._instance.nameSpace,".aciTreePush",function(i){var e=i.target;a.hasClass(e,"aciTreePush")||(e=a.parentByClass(e,"aciTreePush")),a.toggleClass(e,"aciTreeHover","mouseenter"==i.type)}).on("mouseenter"+this._instance.nameSpace+" mouseleave"+this._instance.nameSpace,".aciTreeLine",function(i){var e=i.target;a.hasClass(e,"aciTreeLine")||(e=a.parentByClass(e,"aciTreeLine")),a.toggleClass(e,"aciTreeHover","mouseenter"==i.type)}),this._initHook();var e=this.proxy(function(){this._super(),this._private.locked=!1,this._trigger(null,"init",i),this._success(null,i)}),t=this.proxy(function(){this._super(),this._private.locked=!1,this._trigger(null,"initfail",i),this._fail(null,i)});this._instance.options.rootData?this.loadFrom(null,this._inner(i,{success:e,fail:t,itemData:this._instance.options.rootData})):this._instance.options.ajax.url?this.ajaxLoad(null,this._inner(i,{success:e,fail:t})):e.apply(this)},_initHook:function(){},isLocked:function(){return this._private.locked},_format:function(i,t){if(!(t instanceof Array))return i;for(var s,n,a,r=i.split(/(%[0-9]+)/gm),o="",h=!1,l=new e.RegExp("^%[0-9]+$"),c=0;c<r.length;c++)if(s=r[c],a=s.length){if(!h&&l.test(s)){if(n=e.parseInt(s.substr(1))-1,n>=0&&n<t.length){o+=t[n];continue}}else h=!1,"%"==s.substr(a-1)&&("%%"!=s.substr(a-2)&&(h=!0),s=s.substr(0,a-1));o+=s}return o},_coreDOM:{leaf:function(i){a.addRemoveListClass(i.toArray(),"aciTreeLeaf",["aciTreeInode","aciTreeInodeMaybe","aciTreeOpen"],function(i){i.firstChild.removeAttribute("aria-expanded")})},inode:function(i,e){a.addRemoveListClass(i.toArray(),e?"aciTreeInode":"aciTreeInodeMaybe","aciTreeLeaf",function(i){i.firstChild.setAttribute("aria-expanded",!1)})},toggle:function(i,e){a.toggleListClass(i.toArray(),"aciTreeOpen",e,function(i){i.firstChild.setAttribute("aria-expanded",e)})},oddEven:function(i,e){for(var t=i.toArray(),s=0;s<t.length;s++)a.addRemoveClass(t[s],e?"aciTreeOdd":"aciTreeEven",e?"aciTreeEven":"aciTreeOdd"),e=!e}},_queue:function(i,t){var s=!1,n=[],a=[],r=0,o=0,h=0,l=0,c=function(){if(s)return void l--;var u=(new e.Date).getTime();if(h>u)return void l--;var d,f=!1;r<2*t.async&&(d=n.shift()),!d&&o<t.async&&(d=a.shift(),f=!0),d&&(f?(o++,d.call(i,function(){o--}),40>l&&(l++,c())):(r++,d.call(i,function(){u-h>t.interval&&(h=u+t.delay),r--,40>l&&(l++,c())}))),l--},u=[],d=function(){for(var i=0;4>i;i++)u[i]=e.setInterval(function(){20>l&&(l++,c())},10)},f=function(){for(var i=0;i<u.length;i++)e.clearInterval(u[i])};d(),this.init=function(){return this.destroy(),d(),this},this.push=function(i,e){return s||(e?a.push(i):n.push(i)),this},this.busy=function(){return 0!=r||0!=o||0!=n.length||0!=a.length},this.destroy=function(){return s=!0,f(),n=[],a=[],r=0,o=0,h=0,l=0,s=!1,this}},_task:function(i,e){var t=0,s=!1;this.push=function(n,a){t++,i.push(function(i){var a=this;n.call(this,function(){t--,1>t&&!s?(s=!0,e.call(a,i)):i()})},a)}},_options:function(e,t,s,n,a){var r=i.extend({uid:"ui",success:null,fail:null,notify:null,expand:this._instance.options.expand,collapse:this._instance.options.collapse,unique:this._instance.options.unique,unanimated:!1,itemData:{}},e),o=t?"string"==typeof t?function(){this._trigger(a,t,r)}:t:null,h=s?"string"==typeof s?function(){this._trigger(a,s,r)}:s:null,l=n?"string"==typeof n?function(){this._trigger(a,n,r)}:n:null;return o&&(e&&e.success?r.success=function(){o.apply(this,arguments),e.success.apply(this,arguments)}:r.success=o),h&&(e&&e.fail?r.fail=function(){h.apply(this,arguments),e.fail.apply(this,arguments)}:r.fail=h),l?e&&e.notify?r.notify=function(){l.apply(this,arguments),e.notify.apply(this,arguments)}:!r.notify&&e&&e.success?r.notify=function(){l.apply(this,arguments),e.success.apply(this,arguments)}:r.notify=l:!r.notify&&e&&e.success&&(r.notify=e.success),r},_inner:function(e,t){return i.extend({},e,{success:null,fail:null,notify:null},t)},_trigger:function(e,t,s){var n=i.Event("acitree");return s||(s=this._options()),this._instance.jQuery.trigger(n,[this,e,t,s]),!n.isDefaultPrevented()},_success:function(i,e){e&&e.success&&e.success.call(this,i,e)},_fail:function(i,e){e&&e.fail&&e.fail.call(this,i,e)},_notify:function(i,e){e&&e.notify&&e.notify.call(this,i,e)},_delayBusy:function(i,t){return this._private.delayBusy<10&&this.isBusy(i)?(this._private.delayBusy++,void e.setTimeout(this.proxy(function(){this._delayBusy.call(this,i,t),this._private.delayBusy--}),10)):void t.apply(this)},_dataSource:function(i){var e=this._instance.options.dataSource;if(e){var t=this.itemData(i);if(t&&t.source&&e[t.source])return e[t.source];var s;do if(s=this.parent(i),t=this.itemData(s),t&&t.source&&e[t.source])return e[t.source];while(s.length)}return this._instance.options.ajax},ajaxLoad:function(e,t){return e&&this.isBusy(e)?void this._delayBusy(e,function(){this.ajaxLoad(e,t)}):(t=this._options(t,function(){this._loading(e),this._trigger(e,"loaded",t)},function(){this._loading(e),this._trigger(e,"loadfail",t)},function(){this._loading(e),this._trigger(e,"wasloaded",t)}),void(!e||this.isInode(e)?this._instance.queue.push(function(s){if(!this._trigger(e,"beforeload",t))return this._fail(e,t),void s();if(this._loading(e,!0),this.wasLoad(e))return this._notify(e,t),void s();var n=i.extend({},this._dataSource(e));this._instance.options.ajaxHook.call(this,e,n),n.success=this.proxy(function(i){if(i&&i instanceof Array&&i.length){var n=function(){this.wasLoad(e)?(this._notify(e,t),s()):this._createBranch(e,this._inner(t,{success:function(){this._success(e,t),s()},fail:function(){this._fail(e,t),s()},itemData:i}))};!e||this.isInode(e)?n.apply(this):this.setInode(e,this._inner(t,{success:n,fail:t.fail}))}else{var n=function(){this._fail(e,t),s()};!e||this.isLeaf(e)?n.apply(this):this.setLeaf(e,this._inner(t,{success:n,fail:n}))}}),n.error=this.proxy(function(){this._fail(e,t),s()}),i.ajax(n)},!0):this._fail(e,t)))},loadFrom:function(i,e){if(i&&this.isBusy(i))return void this._delayBusy(i,function(){this.loadFrom(i,e)});if(e=this._options(e,function(){this._loading(i),this._trigger(i,"loaded",e)},function(){this._loading(i),this._trigger(i,"loadfail",e)},function(){this._loading(i),this._trigger(i,"wasloaded",e)}),!i||this.isInode(i)){if(!this._trigger(i,"beforeload",e))return void this._fail(i,e);if(this._loading(i,!0),this.wasLoad(i))return void this._notify(i,e);if(e.itemData&&e.itemData instanceof Array&&e.itemData.length){var t=function(){this.wasLoad(i)?this._notify(i,e):this._createBranch(i,e)};!i||this.isInode(i)?t.apply(this):this.setInode(i,this._inner(e,{success:t,fail:e.fail}))}else!i||this.isLeaf(i)?this._fail(i,e):this.setLeaf(i,this._inner(e,{success:e.fail,fail:e.fail}))}else this._fail(i,e)},unload:function(e,t){if(t=this._options(t,function(){this._loading(e),this._trigger(e,"unloaded",t)},function(){this._loading(e),this._trigger(e,"unloadfail",t)},function(){this._loading(e),this._trigger(e,"notloaded",t)}),!e||this.isInode(e)){if(!this._trigger(e,"beforeunload",t))return void this._fail(e,t);if(this._loading(e,!0),!this.wasLoad(e))return void this._notify(e,t);var s=!1,n=this.children(e,!0,!0);if(n.each(this.proxy(function(e){var n=i(e);if(this.isInode(n)){if(this.isOpen(n)&&!this._trigger(n,"beforeclose",t))return s=!0,!1;if(this.wasLoad(n)&&!this._trigger(n,"beforeunload",t))return s=!0,!1}return this._trigger(n,"beforeremove",t)?void 0:(s=!0,!1)},!0)),s)return void this._fail(e,t);var a=function(){n.each(this.proxy(function(e){var s=i(e);this.isInode(s)&&(this.isOpen(s)&&this._trigger(s,"closed",t),this.wasLoad(s)&&this._trigger(s,"unloaded",t)),this._trigger(s,"removed",t)},!0))};e?this.isOpen(e)?this.close(e,this._inner(t,{success:function(){a.call(this),this._removeContainer(e),this._success(e,t)},fail:t.fail})):(a.call(this),this._removeContainer(e),this._success(e,t)):this._animate(e,!1,!this._instance.options.animateRoot||t.unanimated,function(){a.call(this),this._removeContainer(),this._success(e,t)})}else this._fail(e,t)},remove:function(i,e){if(this.isItem(i))if(this.hasSiblings(i,!0)){if(e=this._options(e,function(){this.isOpenPath(i)&&(a.removeClass(i[0],"aciTreeVisible"),this._setOddEven(i)),this._trigger(i,"removed",e)},"removefail",null,i),!this._trigger(i,"beforeremove",e))return void this._fail(i,e);this.wasLoad(i)?this.unload(i,this._inner(e,{success:function(){this._success(i,e),this._removeItem(i)},fail:e.fail})):(this._success(i,e),this._removeItem(i))}else{var t=this.parent(i);t.length?this.setLeaf(t,e):this.unload(null,e)}else this._trigger(i,"removefail",e),this._fail(i,e)},_openChildren:function(e,t){if(t.expand){var s=this._instance.queue;this.inodes(this.children(e)).each(function(){var e=i(this);s.push(function(i){this.open(e,this._inner(t)),i()})}),s.push(function(i){this._success(e,t),i()})}else this._success(e,t)},_openItem:function(i,e){e.unanimated||this.isVisible(i)||(e.unanimated=!0),e.unique&&(this.closeOthers(i),e.unique=!1),this._coreDOM.toggle(i,!0),this._setOddEvenChildren(i),this._animate(i,!0,e.unanimated,function(){this._openChildren(i,e)})},open:function(i,e){if(e=this._options(e,function(){this.isOpenPath(i)&&(this._updateVisible(i),this._setOddEven(i)),this._trigger(i,"opened",e)},"openfail","wasopened",i),this.isInode(i)){if(!this._trigger(i,"beforeopen",e))return void this._fail(i,e);this.isOpen(i)?(e.success=e.notify,this._openChildren(i,e)):this.wasLoad(i)?this._openItem(i,e):this.ajaxLoad(i,this._inner(e,{success:function(){this._openItem(i,e)},fail:e.fail}))}else this._fail(i,e)},_closeChildren:function(e,t){if(this._instance.options.empty)t.unanimated=!0,this.unload(e,t);else if(t.collapse){var s=this._instance.queue;this.inodes(this.children(e)).each(function(){var e=i(this);s.push(function(i){this.close(e,this._inner(t,{unanimated:!0})),i()})}),s.push(function(i){this._success(e,t),i()})}else this._success(e,t)},_closeItem:function(i,e){e.unanimated||this.isVisible(i)||(e.unanimated=!0),this._coreDOM.toggle(i,!1),this._animate(i,!1,e.unanimated,function(){this._closeChildren(i,e)})},close:function(i,e){if(e=this._options(e,function(){this.isOpenPath(i)&&(this._updateVisible(i),this._setOddEven(i)),this._trigger(i,"closed",e)},"closefail","wasclosed",i),this.isInode(i)){if(!this._trigger(i,"beforeclose",e))return void this._fail(i,e);this.isOpen(i)?this._closeItem(i,e):this.wasLoad(i)?(e.success=e.notify,this._closeChildren(i,e)):this._notify(i,e)}else this._fail(i,e)},_updateVisible:function(e){this.isOpenPath(e)?this.isHidden(e)||(a.addClass(e[0],"aciTreeVisible"),this.isOpen(e)?a.children(e[0],!1,this.proxy(function(e){a.hasClass(e,"aciTreeVisible")||this._updateVisible(i(e))})):a.children(e[0],!0,function(i){return a.removeClass(i,"aciTreeVisible")?!0:null})):a.removeClass(e[0],"aciTreeVisible")&&a.children(e[0],!0,function(i){return a.removeClass(i,"aciTreeVisible")?!0:null})},closeOthers:function(e,t){if(t=this._options(t),this.isItem(e)){var s=this._instance.queue,n=e.add(this.path(e)).add(this.children(e,!0));this.inodes(this.children(null,!0,!0),!0).not(n).each(function(){var e=i(this);s.push(function(i){this.close(e,this._inner(t)),i()})}),s.push(function(i){this._success(e,t),i()})}else this._fail(e,t)},toggle:function(i,e){if(e=this._options(e,"toggled","togglefail",null,i),this.isInode(i)){if(!this._trigger(i,"beforetoggle",e))return void this._fail(i,e);this.isOpen(i)?this.close(i,e):this.open(i,e)}else this._fail(i,e)},path:function(e,t){if(e){for(var s=e[0],n=[];s=a.parent(s);)n.push(s);return i(t?n:n.reverse())}return i([])},isVisible:function(i,e){if(i&&a.hasClass(i[0],"aciTreeVisible")){var t=this._instance.jQuery[0].getBoundingClientRect(),s=i[0].firstChild,n=s.getBoundingClientRect(),r=s.offsetHeight,o=e?(t.bottom-t.top)/2:0;return n.bottom-r<t.top+o||n.top+r>t.bottom-o?!1:!0}return!1},openPath:function(e,t){if(t=this._options(t),this.isItem(e)){var s=this._instance.queue;this.inodes(this.path(e),!1).each(function(){var e=i(this);s.push(function(i){this.open(e,this._inner(t)),i()})}),s.push(function(i){this._success(e,t),i()})}else this._fail(e,t)},isOpenPath:function(i){var e=this.parent(i);return e[0]?this.isOpen(e)&&a.hasClass(e[0],"aciTreeVisible"):!0},_speedFraction:function(i,e,t){if(e>t&&e){var s=parseInt(i);if(isNaN(s))switch(i){case"slow":s=600;break;case"medium":s=400;break;case"fast":s=200;break;default:return i}return s*t/e}return i},setVisible:function(i,e){if(e=this._options(e,"visible","visiblefail","wasvisible",i),this.isItem(i)){if(!this._trigger(i,"beforevisible",e))return void this._fail(i,e);if(this.isVisible(i))return void this._notify(i,e);var t=function(){var t=this._instance.jQuery[0].getBoundingClientRect(),s=i[0].firstChild,n=s.getBoundingClientRect(),a=s.offsetHeight,r=e.center?(t.bottom-t.top)/2:0;if(n.bottom-a<t.top+r){var o=t.top+r-n.bottom+a;!e.unanimated&&this._instance.options.view?this._instance.jQuery.stop(!0).animate({scrollTop:this._instance.jQuery.scrollTop()-o},{duration:this._speedFraction(this._instance.options.view.duration,t.bottom-t.top,o),easing:this._instance.options.view.easing,complete:this.proxy(function(){this._success(i,e)})}):(this._instance.jQuery.stop(!0)[0].scrollTop=this._instance.jQuery.scrollTop()-o,this._success(i,e))}else if(n.top+a>t.bottom-r){var o=n.top-t.bottom+r+a;!e.unanimated&&this._instance.options.view?this._instance.jQuery.stop(!0).animate({scrollTop:this._instance.jQuery.scrollTop()+o},{duration:this._speedFraction(this._instance.options.view.duration,t.bottom-t.top,o),easing:this._instance.options.view.easing,complete:this.proxy(function(){this._success(i,e)})}):(this._instance.jQuery.stop(!0)[0].scrollTop=this._instance.jQuery.scrollTop()+o,this._success(i,e))}else this._success(i,e)};this.hasParent(i)?this.openPath(i,this._inner(e,{success:t,fail:e.fail})):t.apply(this)}else this._fail(i,e)},hasParent:function(i){return this.parent(i).length>0},parent:function(e){return i(e?a.parent(e[0]):[])},topParent:function(i){return this.path(i).eq(0)},_createBranch:function(i,e){var t=0,s=function(i){for(var e,n=0;n<i.length;n++)e=i[n],e.branch&&e.branch instanceof Array&&e.branch.length&&s(e.branch);t++};s(e.itemData);var n=0,r=this.proxy(function(){n++,n>=t&&this._success(i,e)}),o=this.proxy(function(i,t){i&&a.addRemoveClass(i[0],"aciTreeInode","aciTreeInodeMaybe"),this.append(i,this._inner(e,{success:function(i,e){for(var t,s=0;s<e.itemData.length;s++)t=e.itemData[s],t.branch&&t.branch instanceof Array&&t.branch.length&&o(e.items.eq(s),t.branch),t.open&&this.open(e.items.eq(s),this._inner(e,{itemData:null,items:null}));r()},fail:e.fail,itemData:t}))});o(i,e.itemData)},_getFirstLast:function(e){return e||(e=this._instance.jQuery),i(a.withAnyClass(a.children(e[0]),["aciTreeFirst","aciTreeLast"]))},_setFirstLast:function(i,e){e&&a.removeListClass(e.toArray(),["aciTreeFirst","aciTreeLast"]);var t=this.first(i);t[0]&&(a.addClass(t[0],"aciTreeFirst"),a.addClass(this.last(i)[0],"aciTreeLast"))},_setOddEven:function(t){var s;this._instance.jQuery[0].getElementsByClassName?(s=this._instance.jQuery[0].getElementsByClassName("aciTreeVisible"),s=s?e.Array.prototype.slice.call(s):[]):s=i(a.children(this._instance.jQuery[0],!0,function(i){return this.hasClass(i,"aciTreeVisible")?!0:null}));var n=!0;if(s.length){var r=0;if(t&&(t.each(function(){if(s.indexOf){var i=s.indexOf(this);-1!=i&&(r=e.Math.min(i,r))}else for(var t=0;t<s.length;t++)if(s[t]===this){r=e.Math.min(t,r);break}}),r=e.Math.max(r-1,0)),r>0){var o=s[r];a.hasClass(o,"aciTreOdd")&&(n=!1),s=s.slice(r+1)}}this._coreDOM.oddEven(i(s),n)},_setOddEvenChildren:function(i){var e=a.hasClass(i[0],"aciTreeOdd"),t=this.children(i);this._coreDOM.oddEven(t,!e)},_itemHook:function(i,e,t,s){this._instance.options.itemHook&&this._instance.options.itemHook.apply(this,arguments)},_createItem:function(t,s){if(this._private.itemClone[s]){for(var n=this._private.itemClone[s].cloneNode(!0),a=n.firstChild,r=a,o=0;s>o;o++)r=r.firstChild;r=r.firstChild.lastChild.firstChild;var h=r.nextSibling}else{var n=e.document.createElement("LI");n.setAttribute("role","presentation");var a=e.document.createElement("DIV");n.appendChild(a),a.setAttribute("tabindex",-1),a.setAttribute("role","treeitem"),a.setAttribute("aria-selected",!1),a.className="aciTreeLine";for(var l,c=a,o=0;s>o;o++)l=e.document.createElement("DIV"),c.appendChild(l),l.className="aciTreeBranch aciTreeLevel"+o,c=l;var u=e.document.createElement("DIV");c.appendChild(u),u.className="aciTreeEntry";var d=e.document.createElement("SPAN");u.appendChild(d),d.className="aciTreeButton";var f=e.document.createElement("SPAN");d.appendChild(f),f.className="aciTreePush",f.appendChild(e.document.createElement("SPAN"));var _=e.document.createElement("SPAN");u.appendChild(_),_.className="aciTreeItem";var r=e.document.createElement("SPAN");_.appendChild(r);var h=e.document.createElement("SPAN");_.appendChild(h),h.className="aciTreeText",this._private.itemClone[s]=n.cloneNode(!0)}n.className="aciTreeLi"+(t.inode||null===t.inode?t.inode||t.branch&&t.branch.length?" aciTreeInode":" aciTreeInodeMaybe":" aciTreeLeaf")+" aciTreeLevel"+s+(t.disabled?" aciTreeDisabled":""),a.setAttribute("aria-level",s+1),(t.inode||null===t.inode)&&a.setAttribute("aria-expanded",!1),t.icon?t.icon instanceof Array?(r.className="aciTreeIcon "+t.icon[0],r.style.backgroundPosition=t.icon[1]+"px "+t.icon[2]+"px"):r.className="aciTreeIcon "+t.icon:r.parentNode.removeChild(r),h.innerHTML=t.label;var p=i(n);return p.data("itemData"+this._instance.nameSpace,i.extend({},t,{branch:t.branch&&t.branch.length})),p},_removeItem:function(i){var e=this.parent(i);i.remove(),this._setFirstLast(e.length?e:null)},_createItems:function(t,s,n,a,r,o){var h=[],l=e.document.createDocumentFragment(),c=new this._task(this._instance.queue,function(e){h=i(h),h.length&&(t?t[0].appendChild(l):s?s[0].parentNode.insertBefore(l,s[0]):n&&n[0].parentNode.insertBefore(l,n[0].nextSibling)),o.call(this,h),e()});if(a){this._loader(!0);var u;if(t?u=this.itemFrom(t):s?u=this.parent(s):n&&(u=this.parent(n)),a instanceof Array)for(var d=0;d<a.length;d++)!function(i){c.push(function(e){var t=this._createItem(i,r);this._itemHook(u,t,i,r),l.appendChild(t[0]),h.push(t[0]),e()})}(a[d]);else c.push(function(i){var e=this._createItem(a,r);this._itemHook(u,e,a,r),l.appendChild(e[0]),h.push(e[0]),i()})}c.push(function(i){i()})},_createContainer:function(t){t||(t=this._instance.jQuery);var s=a.container(t[0]);if(!s){var s=e.document.createElement("UL");s.setAttribute("role","group"),s.className="aciTreeUl",s.style.display="none",t[0].appendChild(s)}return i(s)},_removeContainer:function(i){i||(i=this._instance.jQuery);var e=a.container(i[0]);e.parentNode.removeChild(e)},append:function(e,t){if(t=this._options(t,"appended","appendfail",null,e),e)if(this.isInode(e)){if(!this._trigger(e,"beforeappend",t))return void this._fail(e,t);var s=this._createContainer(e),n=this.last(e);this._createItems(s,null,null,t.itemData,this.level(e)+1,function(r){r.length?(a.addRemoveClass(e[0],"aciTreeInode","aciTreeInodeMaybe"),this._setFirstLast(e,n),this.isHidden(e)?a.addListClass(r.toArray(),"aciTreeHidden"):this.isOpenPath(e)&&this.isOpen(e)&&(a.addListClass(r.toArray(),"aciTreeVisible"),this._setOddEven(r.first())),r.each(this.proxy(function(e){this._trigger(i(e),"added",t)},!0))):this.hasChildren(e,!0)||s.remove(),t.items=r,this._success(e,t)})}else this._fail(e,t);else{if(!this._trigger(e,"beforeappend",t))return void this._fail(e,t);var s=this._createContainer(),n=this.last();this._createItems(s,null,null,t.itemData,0,function(r){r.length?(this._setFirstLast(null,n),a.addListClass(r.toArray(),"aciTreeVisible"),this._setOddEven(),r.each(this.proxy(function(e){this._trigger(i(e),"added",t)},!0)),this._animate(null,!0,!this._instance.options.animateRoot||t.unanimated)):this.hasChildren(null,!0)||s.remove(),t.items=r,this._success(e,t)})}},before:function(e,t){if(t=this._options(t,"before","beforefail",null,e),this.isItem(e)){if(!this._trigger(e,"beforebefore",t))return void this._fail(e,t);var s=this.prev(e);this._createItems(null,e,null,t.itemData,this.level(e),function(n){if(n.length){s.length||(a.removeClass(e[0],"aciTreeFirst"),a.addClass(n.first()[0],"aciTreeFirst"));var r=this.parent(e);r.length&&this.isHidden(r)?a.addListClass(n.toArray(),"aciTreeHidden"):this.isOpenPath(e)&&(a.addListClass(n.toArray(),"aciTreeVisible"),this._setOddEven(n.first())),n.each(this.proxy(function(e){this._trigger(i(e),"added",t)},!0))}t.items=n,this._success(e,t)})}else this._fail(e,t)},after:function(e,t){if(t=this._options(t,"after","afterfail",null,e),this.isItem(e)){if(!this._trigger(e,"beforeafter",t))return void this._fail(e,t);var s=this.next(e);this._createItems(null,null,e,t.itemData,this.level(e),function(n){if(n.length){s.length||(a.removeClass(e[0],"aciTreeLast"),a.addClass(n.last()[0],"aciTreeLast"));var r=this.parent(e);r.length&&this.isHidden(r)?a.addListClass(n.toArray(),"aciTreeHidden"):this.isOpenPath(e)&&(a.addListClass(n.toArray(),"aciTreeVisible"),this._setOddEven(n.first())),n.each(this.proxy(function(e){this._trigger(i(e),"added",t)},!0))}t.items=n,this._success(e,t)})}else this._fail(e,t)},itemFrom:function(e){if(e){var t=i(e);return i(t[0]===this._instance.jQuery[0]?[]:a.parentFrom(t[0]))}return i([])},children:function(e,t,s){return i(a.children(e&&e[0]?e[0]:this._instance.jQuery[0],t,s?null:function(i){return this.hasClass(i,"aciTreeHidden")?null:!0}))},visible:function(e,t){var s=a.withClass(e.toArray(),"aciTreeVisible");if(t){for(var n=[],r=0;r<s.length;r++)this.isVisible(i(s[r]))&&n.push(s[r]);return i(n)}return i(s)},inodes:function(e,s){return i(s!==t?s?a.withClass(e.toArray(),"aciTreeOpen"):a.withAnyClass(e.toArray(),["aciTreeInode","aciTreeInodeMaybe"],"aciTreeOpen"):a.withAnyClass(e.toArray(),["aciTreeInode","aciTreeInodeMaybe"]))},leaves:function(e){return i(a.withClass(e.toArray(),"aciTreeLeaf"))},isInode:function(i){return i&&a.hasAnyClass(i[0],["aciTreeInode","aciTreeInodeMaybe"])},isLeaf:function(i){return i&&a.hasClass(i[0],"aciTreeLeaf")},wasLoad:function(i){return i?null!==a.container(i[0]):null!==a.container(this._instance.jQuery[0])},setInode:function(i,e){if(e=this._options(e,"inodeset","inodefail","wasinode",i),this.isItem(i)){if(!this._trigger(i,"beforeinode",e))return void this._fail(i,e);this.isLeaf(i)?(this._coreDOM.inode(i,!0),this._success(i,e)):this._notify(i,e)}else this._fail(i,e)},setLeaf:function(i,e){if(e=this._options(e,"leafset","leaffail","wasleaf",i),this.isItem(i)){if(!this._trigger(i,"beforeleaf",e))return void this._fail(i,e);if(this.isInode(i)){var t=function(){this._coreDOM.leaf(i),this._success(i,e)};this.wasLoad(i)?this.unload(i,this._inner(e,{success:t,fail:e.fail})):t.apply(this)}else this._notify(i,e)}else this._fail(i,e)},addIcon:function(i,t){if(t=this._options(t,"iconadded","addiconfail","wasicon",i),this.isItem(i)){if(!this._trigger(i,"beforeaddicon",t))return void this._fail(i,t);var s=this.itemData(i);t.oldIcon=s.icon;var n=a.childrenByClass(i[0].firstChild,"aciTreeItem"),r=a.childrenByClass(n,"aciTreeIcon");r&&s.icon&&t.icon.toString()==s.icon.toString()?this._notify(i,t):(r||(r=e.document.createElement("DIV"),n.insertBefore(r,n.firstChild)),t.icon instanceof Array?(r.className="aciTreeIcon "+t.icon[0],r.style.backgroundPosition=t.icon[1]+"px "+t.icon[2]+"px"):r.className="aciTreeIcon "+t.icon,s.icon=t.icon,this._success(i,t))}else this._fail(i,t)},removeIcon:function(i,e){if(e=this._options(e,"iconremoved","removeiconfail","noticon",i),this.isItem(i)){if(!this._trigger(i,"beforeremoveicon",e))return void this._fail(i,e);var t=this.itemData(i);e.oldIcon=t.icon;var s=a.childrenByClass(i[0].firstChild,"aciTreeItem"),n=a.childrenByClass(s,"aciTreeIcon");n?(s.removeChild(n),t.icon=null,this._success(i,e)):this._notify(i,e)}else this._fail(i,e)},hasIcon:function(i){return!!this.getIcon(i)},getIcon:function(i){var e=this.itemData(i);return e?e.icon:null},setLabel:function(i,e){if(e=this._options(e,"labelset","labelfail","waslabel",i),this.isItem(i)){if(!this._trigger(i,"beforelabel",e))return void this._fail(i,e);var t=this.itemData(i);e.oldLabel=t.label,e.label==e.oldLabel?this._notify(i,e):(a.childrenByClass(i[0].firstChild,"aciTreeText").innerHTML=e.label,t.label=e.label,this._success(i,e))}else this._fail(i,e)},disable:function(i,e){if(e=this._options(e,"disabled","disablefail","wasdisabled",i),this.isItem(i)){if(!this._trigger(i,"beforedisable",e))return void this._fail(i,e);this.isDisabled(i)?this._notify(i,e):(a.addClass(i[0],"aciTreeDisabled"),this._success(i,e))}else this._fail(i,e)},isDisabled:function(i){return i&&a.hasClass(i[0],"aciTreeDisabled")},isDisabledPath:function(i){return a.withClass(this.path(i).toArray(),"aciTreeDisabled").length>0},disabled:function(e){return i(a.withClass(e.toArray(),"aciTreeDisabled"))},enable:function(i,e){if(e=this._options(e,"enabled","enablefail","wasenabled",i),this.isItem(i)){if(!this._trigger(i,"beforeenable",e))return void this._fail(i,e);this.isDisabled(i)?(a.removeClass(i[0],"aciTreeDisabled"),this._success(i,e)):this._notify(i,e)}else this._fail(i,e)},isEnabled:function(i){return i&&!a.hasClass(i[0],"aciTreeDisabled")},isEnabledPath:function(i){return 0==a.withClass(this.path(i).toArray(),"aciTreeDisabled").length},enabled:function(e){return i(a.withClass(e.toArray(),null,"aciTreeDisabled"))},hide:function(i,e){if(e=this._options(e,"hidden","hidefail","washidden",i),this.isItem(i)){if(!this._trigger(i,"beforehide",e))return void this._fail(i,e);if(this.isHidden(i))this._notify(i,e);else{a.addRemoveClass(i[0],"aciTreeHidden","aciTreeVisible"),a.addRemoveClass(this.children(i,!0).toArray(),"aciTreeHidden","aciTreeVisible");var t=this.parent(i);this._setFirstLast(t.length?t:null,i),this._setOddEven(i),this._success(i,e)}}else this._fail(i,e)},isHidden:function(i){return i&&a.hasClass(i[0],"aciTreeHidden")},isHiddenPath:function(i){var e=this.parent(i);return e[0]&&a.hasClass(e[0],"aciTreeHidden")},_updateHidden:function(i){this.isHiddenPath(i)?this.isHidden(i)||(a.addClass(i[0],"aciTreeHidden"),this._updateVisible(i)):this._updateVisible(i)},hidden:function(e){return i(a.withClass(e.toArray(),"aciTreeHidden"))},_showHidden:function(e){var t=null;this.path(e).add(e).each(this.proxy(function(e){var s=i(e);this.isHidden(s)&&(a.removeClass(s[0],"aciTreeHidden"),!this.isOpenPath(s)||t&&!this.isOpen(t)||a.addClass(s[0],"aciTreeVisible"),this._setFirstLast(t,this._getFirstLast(t))),t=s},!0))},show:function(i,e){if(e=this._options(e,"shown","showfail","wasshown",i),this.isItem(i)){if(!this._trigger(i,"beforeshow",e))return void this._fail(i,e);if(this.isHidden(i)){this._showHidden(i);var t=this.topParent(i);this._setOddEven(t.length?t:i),this._success(i,e)}else this._notify(i,e)}else this._fail(i,e)},isOpen:function(i){return i&&a.hasClass(i[0],"aciTreeOpen")},isClosed:function(i){return i&&!a.hasClass(i[0],"aciTreeOpen")},hasChildren:function(i,e){return this.children(i,!1,e).length>0},hasSiblings:function(i,e){return this.siblings(i,e).length>0},hasPrev:function(i,e){return this.prev(i,e).length>0},hasNext:function(i,e){return this.next(i,e).length>0},siblings:function(e,t){return i(e?a.children(e[0].parentNode.parentNode,!1,function(i){return i!=e[0]&&(t||!this.hasClass(i,"aciTreeHidden"))}):[])},prev:function(e,t){return i(e?a.prev(e[0],t?null:function(i){return!this.hasClass(i,"aciTreeHidden")}):[])},next:function(e,t){return i(e?a.next(e[0],t?null:function(i){return!this.hasClass(i,"aciTreeHidden")}):[])},level:function(i){var e=-1;if(i)for(var t=i[0];a.hasClass(t,"aciTreeLi");)t=t.parentNode.parentNode,e++;return e},getId:function(i){var e=this.itemData(i);return e?e.id:null},itemData:function(i){return i?i.data("itemData"+this._instance.nameSpace):null},setId:function(i,e){if(e=this._options(e,"idset","idfail","wasid",i),this.isItem(i)){if(!this._trigger(i,"beforeid",e))return void this._fail(i,e);var t=this.itemData(i);e.oldId=t.id,e.id==e.oldId?this._notify(i,e):(t.id=e.id,this._success(i,e))}else this._fail(i,e)},getIndex:function(i){if(i&&i[0]){if(e.Array.prototype.indexOf)return e.Array.prototype.indexOf.call(i[0].parentNode.childNodes,i[0]);for(var t=i[0].parentNode.childNodes,s=0;s<t.length;s++)if(t[s]==i[0])return s}return null},setIndex:function(i,e){if(e=this._options(e,"indexset","indexfail","wasindex",i),this.isItem(i)){var t=this.getIndex(i),s=this.siblings(i);if(e.index!=t&&!s.length)return void this._fail(i,e);if(!this._trigger(i,"beforeindex",e))return void this._fail(i,e);if(e.oldIndex=t,e.index==t)this._notify(i,e);else{e.index<1?s.first().before(i):e.index>=s.length?s.last().after(i):s.eq(e.index).before(i);var n=this.parent(i);this._setFirstLast(n.length?n:null,i.add([s[0],s.get(-1)])),this._setOddEven(n),this._success(i,e)}}else this._fail(i,e)},getLabel:function(i){var e=this.itemData(i);return e?e.label:null},isItem:function(i){return i&&a.hasClass(i[0],"aciTreeLi")},_animate:function(e,t,s,n){if(e||(e=this._instance.jQuery),!s){var r=t?this._instance.options.show:this._instance.options.hide;if(r){var o=a.container(e[0]);return void(o?i(o).stop(!0,!0).animate(r.props,{duration:r.duration,easing:r.easing,complete:n?this.proxy(n):null}):n&&n.apply(this))}}i(a.container(e[0])).stop(!0,!0).toggle(t),n&&n.apply(this)},first:function(e,t){return e||(e=this._instance.jQuery),i(a.firstChild(e[0],t?null:function(i){return!this.hasClass(i,"aciTreeHidden")}))},isFirst:function(e,t){if(e){var s=a.parent(e[0]);return this.first(s?i(s):null,t)[0]==e[0]}return!1},last:function(e,t){return e||(e=this._instance.jQuery),i(a.lastChild(e[0],t?null:function(i){return!this.hasClass(i,"aciTreeHidden")}))},isLast:function(e,t){if(e){var s=a.parent(e[0]);return this.last(s?i(s):null,t)[0]==e[0]}return!1},isBusy:function(i){return i?a.hasClass(i[0],"aciTreeLoad"):this._instance.queue.busy()},_loading:function(i,e){i?(a.toggleClass(i[0],"aciTreeLoad",e),e?i[0].firstChild.setAttribute("aria-busy",!0):i[0].firstChild.removeAttribute("aria-busy")):e&&this._loader(e)},_loader:function(i){(i||this.isBusy())&&(this._private.loaderInterval||(this._private.loaderInterval=e.setInterval(this.proxy(function(){this._loader()}),this._instance.options.loaderDelay)),a.addClass(this._instance.jQuery[0],"aciTreeLoad"),e.clearTimeout(this._private.loaderHide),this._private.loaderHide=e.setTimeout(this.proxy(function(){a.removeClass(this._instance.jQuery[0],"aciTreeLoad")}),2*this._instance.options.loaderDelay))},isChildren:function(i,e){return i||(i=this._instance.jQuery),e&&i.has(e).length>0},isImmediateChildren:function(i,e){return i||(i=this._instance.jQuery),e&&i.children(".aciTreeUl").children(".aciTreeLi").is(e)},sameParent:function(i,e){
if(i&&e){var t=this.parent(i),s=this.parent(e);return!t.length&&!s.length||t[0]==s[0]}return!1},sameTopParent:function(i,e){if(i&&e){var t=this.topParent(i),s=this.topParent(e);return!t.length&&!s.length||t[0]==s[0]}return!1},_serialize:function(e,t){var s=this.itemData(e);return this.isInode(e)?(s.inode=!0,this.wasLoad(e)?(s.hasOwnProperty("open")?s.open=this.isOpen(e):this.isOpen(e)&&(s.open=!0),s.branch=[],this.children(e,!1,!0).each(this.proxy(function(e){var n=this._serialize(i(e),t);n=t?t.call(this,i(e),{},n):this._instance.options.serialize.call(this,i(e),{},n),n&&s.branch.push(n)},!0)),s.branch.length||(s.branch=null)):(s.hasOwnProperty("open")&&(s.open=!1),s.hasOwnProperty("branch")&&(s.branch=null))):(s.hasOwnProperty("inode")&&(s.inode=!1),s.hasOwnProperty("open")&&(s.open=null),s.hasOwnProperty("branch")&&(s.branch=null)),s.hasOwnProperty("disabled")?s.disabled=this.isDisabled(e):this.isDisabled(e)&&(s.disabled=!0),s},serialize:function(e,t,s){if("object"==typeof t){if(e){var n=this._serialize(e,s);return n=s?s.call(this,e,{},n):this._instance.options.serialize.call(this,e,{},n)}var a=[];return this.children(null,!1,!0).each(this.proxy(function(e){var t=this._serialize(i(e),s);t=s?s.call(this,i(e),{},t):this._instance.options.serialize.call(this,i(e),{},t),t&&a.push(t)},!0)),a}return""},destroy:function(i){return i=this._options(i),this.wasInit()?this.isLocked()?(this._trigger(null,"locked",i),void this._fail(null,i)):this._trigger(null,"beforedestroy",i)?(this._private.locked=!0,this._instance.jQuery.addClass("aciTreeLoad").attr("aria-busy",!0),this._instance.queue.destroy(),this._destroyHook(!1),void this.unload(null,this._inner(i,{success:this.proxy(function(){e.clearTimeout(this._private.loaderHide),e.clearInterval(this._private.loaderInterval),this._private.itemClone={},this._destroyHook(!0),this._instance.jQuery.unbind(this._instance.nameSpace).off(this._instance.nameSpace,".aciTreeButton").off(this._instance.nameSpace,".aciTreeLine"),this._instance.jQuery.removeClass("aciTree"+this._instance.index+" aciTreeLoad").removeAttr("role aria-busy"),this._private.locked=!1,this._super(),this._trigger(null,"destroyed",i),this._success(null,i)}),fail:function(){this._instance.jQuery.removeClass("aciTreeLoad"),this._private.locked=!1,this._trigger(null,"destroyfail",i),this._fail(null,i)}}))):(this._trigger(null,"destroyfail",i),void this._fail(null,i)):(this._trigger(null,"notinit",i),void this._fail(null,i))},_destroyHook:function(i){}};aciPluginClass.plugins.aciTree=aciPluginClass.aciPluginUi.extend(n,"aciTreeCore"),aciPluginClass.publish("aciTree",s);var a=aciPluginClass.plugins.aciTree_dom}(jQuery,this);

// utils
!function(t,i,s){var e={filterHook:function(t,s,e){return s.length?e.test(i.String(this.getLabel(t))):!0}},n={__extend:function(){t.extend(this._instance,{filter:new this._queue(this,this._instance.options.queue)}),this._instance.filter.destroy(),this._super()},branch:function(t,i,s){var e=this._instance.queue,n=this.proxy(function(t,i,h){var l=h?this.next(t):this.first(t);l.length&&(this.isInode(l)?this.wasLoad(l)?e.push(function(t){i.call(this,l),n(l,i),n(l,i,!0),t()}):s?this.ajaxLoad(l,{success:function(){i.call(this,l),n(l,i),n(l,i,!0)},fail:function(){n(l,i,!0)}}):e.push(function(t){i.call(this,l),n(l,i,!0),t()}):e.push(function(t){i.call(this,l),n(l,i,!0),t()}))});n(t,i)},swap:function(t){t=this._options(t,null,"swapfail",null,null);var i=t.item1,s=t.item2;if(this.isItem(i)&&this.isItem(s)&&!this.isChildren(i,s)&&!this.isChildren(s,i)&&i[0]!=s[0]){if(!this._trigger(null,"beforeswap",t))return void this._fail(null,t);var e=this.prev(i);if(e.length)s[0]==e[0]?s.before(i):(i.insertAfter(s),s.insertAfter(e));else{var n=this.next(i);if(n.length)s[0]==n[0]?s.after(i):(i.insertAfter(s),s.insertBefore(n));else{var h=i.parent();i.insertAfter(s),h.append(s)}}this._updateLevel(i);var h=this.parent(i);this._setFirstLast(h.length?h:null,i),this._updateHidden(i),this._updateLevel(s),h=this.parent(s),this._setFirstLast(h.length?h:null,s),this._updateHidden(s),this._setOddEven(i.add(s)),this._trigger(null,"swapped",t),this._success(null,t)}else this._fail(null,t)},_updateItemLevel:function(t,s,e){h.addRemoveClass(t[0],"aciTreeLevel"+e,"aciTreeLevel"+s);var n=t[0].firstChild;n.setAttribute("aria-level",e+1);var l=h.childrenByClass(n,"aciTreeEntry");if(e>s){n=l.parentNode;for(var a,r=s;e>r;r++)a=i.document.createElement("DIV"),n.appendChild(a),a.className="aciTreeBranch aciTreeLevel"+r,n=a;n.appendChild(l)}else{for(var a=l,r=e;s>=r;r++)a=a.parentNode;a.removeChild(a.firstChild),a.appendChild(l)}},_updateChildLevel:function(i,s,e){this.children(i,!1,!0).each(this.proxy(function(i){var n=t(i);this._updateItemLevel(n,s,e),this.isInode(n)&&this._updateChildLevel(n,s+1,e+1)},!0))},_updateLevel:function(t){var s=this.level(t),e=i.parseInt(t.attr("class").match(/aciTreeLevel[0-9]+/)[0].match(/[0-9]+/));s!=e&&(this._updateItemLevel(t,e,s),this._updateChildLevel(t,e+1,s+1))},moveUp:function(t,s){s=this._options(s),s.index=i.Math.max(this.getIndex(t)-1,0),this.setIndex(t,s)},moveDown:function(t,s){s=this._options(s),s.index=i.Math.min(this.getIndex(t)+1,this.siblings(t).length),this.setIndex(t,s)},moveFirst:function(t,i){i=this._options(i),i.index=0,this.setIndex(t,i)},moveLast:function(t,i){i=this._options(i),i.index=this.siblings(t).length,this.setIndex(t,i)},moveBefore:function(t,i){i=this._options(i,null,"movefail","wasbefore",t);var s=i.before;if(this.isItem(t)&&this.isItem(s)&&!this.isChildren(t,s)&&t[0]!=s[0]){if(!this._trigger(t,"beforemove",i))return void this._fail(t,i);if(this.prev(s,!0)[0]==t[0])this._notify(t,i);else{var e=this.parent(t),n=this.prev(t,!0);n.length||(n=e.length?e:this.first()),t.insertBefore(s),e.length&&!this.hasChildren(e,!0)&&this.setLeaf(e),this._updateLevel(t),this._setFirstLast(e.length?e:null),e=this.parent(t),this._setFirstLast(e.length?e:null,t.add(s)),this._updateHidden(t),this._setOddEven(t.add(s).add(n)),this._trigger(t,"moved",i),this._success(t,i)}}else this._fail(t,i)},moveAfter:function(t,i){i=this._options(i,null,"movefail","wasafter",t);var s=i.after;if(this.isItem(t)&&this.isItem(s)&&!this.isChildren(t,s)&&t[0]!=s[0]){if(!this._trigger(t,"beforemove",i))return void this._fail(t,i);if(this.next(s,!0)[0]==t[0])this._notify(t,i);else{var e=this.parent(t),n=this.prev(t,!0);n.length||(n=e.length?e:this.first()),t.insertAfter(s),e.length&&!this.hasChildren(e,!0)&&this.setLeaf(e),this._updateLevel(t),this._setFirstLast(e.length?e:null),e=this.parent(t),this._setFirstLast(e.length?e:null,t.add(s)),this._updateHidden(t),this._setOddEven(t.add(s).add(n)),this._trigger(t,"moved",i),this._success(t,i)}}else this._fail(t,i)},asChild:function(t,i){i=this._options(i,null,"childfail",null,t);var s=i.parent;if(this.isItem(t)&&this.isItem(s)&&!this.isChildren(t,s)&&!this.hasChildren(s,!0)&&t[0]!=s[0]){if(!this._trigger(t,"beforechild",i))return void this._fail(t,i);var e=function(){var e=this.parent(t),n=this.prev(t);n.length||(n=e.length?e:this.first());var h=this._createContainer(s);h.append(t),e.length&&!this.hasChildren(e,!0)&&this.setLeaf(e),this._updateLevel(t),this._setFirstLast(e.length?e:null),this._setFirstLast(s.length?s:null,t),this._updateHidden(t),this._setOddEven(t.add(n)),this._trigger(t,"childset",i),this._success(t,i)};this.isInode(s)?e.apply(this):this.setInode(s,this._inner(i,{success:e,fail:i.fail}))}else this._fail(t,i)},_search:function(t,s){for(var e,n,h,l,a=this.children(t),r=!1,c=0,o=a.length;o>c;c++)if(e=a.eq(c),n=i.String(this.getId(e)),h=n.length,h&&n==s.substr(0,h)){l=e,r=s.length==h;break}if(l){if(!r){var f=this._search(l,s);if(f)return f}return{item:l,exact:r}}return null},searchId:function(i,s,e){e=this._options(e);var n=e.id;if(i)if(s){var h=this.proxy(function(t){var i=this._search(t,n);i?i.exact?this._success(i.item,e):this.wasLoad(i.item)?this._fail(t,e):this.ajaxLoad(i.item,this._inner(e,{success:function(){h(i.item)},fail:e.fail})):this._fail(t,e)});h()}else{var l=this._search(null,n);l&&l.exact?this._success(l.item,e):this._fail(null,e)}else{var l=t();this._instance.jQuery.find(".aciTreeLi").each(this.proxy(function(i){return n==this.getId(t(i))?(l=t(i),!1):void 0},!0)),l.length?this._success(l,e):this._fail(null,e)}},search:function(i,s){var e=[];s=this._options(s);var n=new this._task(new this._queue(this,this._instance.options.queue),function(n){e.length?(s.results=t(e),this._success(t(e[0]),s)):this._fail(i,s),n()}),h=this.proxy(function(i){this.children(i,!1,!0).each(this.proxy(function(i){if(s.callback){var h=s.callback.call(this,t(i),s.search);if(h)e.push(i);else if(null===h)return}else this.getId(t(i))==s.search&&e.push(i);this.isInode(t(i))&&n.push(function(s){l(t(i)),s()})},!0))}),l=this.proxy(function(t){this.wasLoad(t)?n.push(function(i){h(t),i()}):s.load&&n.push(function(i){this.ajaxLoad(t,{success:function(){h(t),i()},fail:i})})});n.push(function(t){l(i),t()})},searchPath:function(t,i){i=this._options(i);var s=i.path,e=this.proxy(function(t,n){this.search(t,{success:function(t){s.length?e(t,s.shift()):this._success(t,i)},fail:function(){this._fail(t,i)},search:n,load:i.load,callback:function(t,i){return this.getId(t)==i?!0:null}})});e(t,s.shift())},pathId:function(i,s){var e=this.path(i,s),n=[];return e.each(this.proxy(function(i){n.push(this.getId(t(i)))},!0)),n},_regexp:function(t){return new i.RegExp(i.String(t).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),"i")},filter:function(s,e){if(e=this._options(e,null,"filterfail",null,s),!s||this.isItem(s)){if(!this._trigger(s,"beforefilter",e))return void this._fail(s,e);var n=i.String(e.search),l=this._regexp(n),a=null;this._instance.filter.init();var r=new this._task(this._instance.filter,function(t){this._instance.filter.destroy(),e.first=a,this._setOddEven(),this._trigger(s,"filtered",e),this._success(s,e),t()}),c=this.proxy(function(i){var s=this.children(i,!1,!0),e=!1;s.each(this.proxy(function(i){var s=t(i);this._instance.options.filterHook.call(this,s,n,l)?(a||(a=s),e=!0,h.removeClass(s[0],"aciTreeHidden")):h.addRemoveClass(s[0],"aciTreeHidden","aciTreeVisible"),this.isInode(s)&&r.push(function(t){c(s),t()})},!0)),e&&(i&&this.isHidden(i)&&this._showHidden(i),(!i||this.isOpenPath(i)&&this.isOpen(i))&&s.not(".aciTreeHidden").addClass("aciTreeVisible"),this._setFirstLast(i,this._getFirstLast(i)))});r.push(function(t){c(s),t()})}else this._fail(s,e)},_firstAll:function(t){t.call(this,this.first())},_lastAll:function(t,i,s){if(t){if(this.isInode(t)){if(this.wasLoad(t))return void this._lastAll(this.last(t),i,s);if(s)return void this.ajaxLoad(t,{success:function(){this._lastAll(this.last(t),i,s)},fail:function(){i.call(this,t)}})}i.call(this,t)}else i.call(this,this.last())},_nextAll:function(t,i,s){if(t){if(this.isInode(t)){if(this.wasLoad(t))return void i.call(this,this.first(t));if(s)return void this.ajaxLoad(t,{success:function(){i.call(this,this.first(t))},fail:function(){this._nextAll(t,i,s)}})}var e=this.next(t);if(e.length)i.call(this,e);else{var n=this.proxy(function(t){var i=this.parent(t);if(i.length){var s=this.next(i);return s.length?s:n(i)}return null});i.call(this,n(t))}}else i.call(this,this.first())},_prevAll:function(t,i,s){if(t){var e=this.prev(t);if(e.length)this.isInode(e)?this._lastAll(e,i,s):i.call(this,e);else{var n=this.parent(t);i.call(this,n.length?n:null)}}else i.call(this,this.last())},prevMatch:function(t,i,s){var e=this._regexp(i);this._instance.filter.init();var n=new this._task(this._instance.filter,function(t){this._instance.filter.destroy(),t()}),h=function(t){n.push(function(n){this._prevAll(t,function(t){t?this._instance.options.filterHook.call(this,t,i,e)?s.call(this,t):h(t):s.call(this,null),n()})})};h(this.isItem(t)?t:null)},nextMatch:function(t,i,s){var e=this._regexp(i);this._instance.filter.init();var n=new this._task(this._instance.filter,function(t){this._instance.filter.destroy(),t()}),h=function(t){n.push(function(n){this._nextAll(t,function(t){t?this._instance.options.filterHook.call(this,t,i,e)?s.call(this,t):h(t):s.call(this,null),n()})})};h(this.isItem(t)?t:null)}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(n,"aciTreeUtils"),aciPluginClass.defaults("aciTree",e);var h=aciPluginClass.plugins.aciTree_dom}(jQuery,this);

// selectable
!function(e,t,s){var i={selectable:!0,multiSelectable:!1,fullRow:!1,textSelection:!1},n={__extend:function(){e.extend(this._instance,{focus:!1}),e.extend(this._private,{blurTimeout:null,spinPoint:null}),this._super()},hasFocus:function(){return this._instance.focus},_selectableInit:function(){this._instance.jQuery.attr("tabindex")===s&&this._instance.jQuery.attr("tabindex",0),this._instance.options.textSelection||this._selectable(!1),this._instance.jQuery.bind("acitree"+this._private.nameSpace,function(t,s,i,n,c){switch(n){case"closed":var l=s.focused();s.isChildren(i,l)&&s._focusOne(i),s.children(i,!0).each(s.proxy(function(t){var s=e(t);this.isSelected(s)&&this.deselect(s)},!0))}}).bind("focusin"+this._private.nameSpace,this.proxy(function(){t.clearTimeout(this._private.blurTimeout),this.hasFocus()||(this._instance.focus=!0,c.addClass(this._instance.jQuery[0],"aciTreeFocus"),this._trigger(null,"focused"))})).bind("focusout"+this._private.nameSpace,this.proxy(function(){t.clearTimeout(this._private.blurTimeout),this._private.blurTimeout=t.setTimeout(this.proxy(function(){this.hasFocus()&&(this._instance.focus=!1,c.removeClass(this._instance.jQuery[0],"aciTreeFocus"),this._trigger(null,"blurred"))}),10)})).bind("keydown"+this._private.nameSpace,this.proxy(function(t){if(this.hasFocus()){var s=this.focused();if(s.length&&this.isBusy(s))return!1;var i=e([]);switch(t.which){case 65:if(this._instance.options.multiSelectable&&t.ctrlKey){var n=this.visible(this.enabled(this.children(null,!0))).not(this.selected());n.each(this.proxy(function(t){this.select(e(t),{focus:!1})},!0)),this.focused().length||this._focusOne(this.visible(n,!0).first()),t.preventDefault()}break;case 38:i=s.length?this._prev(s):this.first();break;case 40:i=s.length?this._next(s):this.first();break;case 37:s.length?this.isOpen(s)?(i=s,this.close(s,{collapse:this._instance.options.collapse,expand:this._instance.options.expand,unique:this._instance.options.unique})):i=this.parent(s):i=this._first();break;case 39:s.length?this.isInode(s)&&this.isClosed(s)?(i=s,this.open(s,{collapse:this._instance.options.collapse,expand:this._instance.options.expand,unique:this._instance.options.unique})):i=this.first(s):i=this._first();break;case 33:i=s.length?this._prevPage(s):this._first();break;case 34:i=s.length?this._nextPage(s):this._first();break;case 36:i=this._first();break;case 35:i=this._last();break;case 13:case 107:i=s,this.isInode(s)&&this.isClosed(s)&&this.open(s,{collapse:this._instance.options.collapse,expand:this._instance.options.expand,unique:this._instance.options.unique});break;case 27:case 109:i=s,this.isOpen(s)&&this.close(s,{collapse:this._instance.options.collapse,expand:this._instance.options.expand,unique:this._instance.options.unique}),27==t.which&&t.preventDefault();break;case 32:i=s,this.isInode(s)&&!t.ctrlKey&&this.toggle(s,{collapse:this._instance.options.collapse,expand:this._instance.options.expand,unique:this._instance.options.unique}),t.preventDefault();break;case 106:i=s,this.isInode(s)&&this.open(s,{collapse:this._instance.options.collapse,expand:!0,unique:this._instance.options.unique})}return i.length?(!this._instance.options.multiSelectable||t.ctrlKey||t.shiftKey||this._unselect(this.selected().not(i)),this.isVisible(i)||this.setVisible(i),t.ctrlKey?32==t.which&&this.isEnabled(i)?(this.isSelected(i)?this.deselect(i):this.select(i),this._private.spinPoint=i):this._focusOne(i):t.shiftKey?this._shiftSelect(i):(!this.isSelected(i)&&this.isEnabled(i)?this.select(i):this._focusOne(i),this._private.spinPoint=i),!1):void 0}})),this._fullRow(this._instance.options.fullRow),this._multiSelectable(this._instance.options.multiSelectable)},_fullRow:function(e){this._instance.jQuery.off(this._private.nameSpace,".aciTreeLine,.aciTreeItem").off(this._private.nameSpace,".aciTreeItem"),this._instance.jQuery.on("mousedown"+this._private.nameSpace+" click"+this._private.nameSpace,e?".aciTreeLine,.aciTreeItem":".aciTreeItem",this.proxy(function(e){var t=this.itemFrom(e.target);this.isVisible(t)||this.setVisible(t),e.ctrlKey?"click"==e.type&&(this.isEnabled(t)?this.isSelected(t)?(this.deselect(t),this._focusOne(t)):this.select(t):this._focusOne(t)):this._instance.options.multiSelectable&&e.shiftKey?this._shiftSelect(t):(!this._instance.options.multiSelectable||this.isSelected(t)&&"click"!=e.type||this._unselect(this.selected().not(t)),this._selectOne(t)),e.shiftKey||(this._private.spinPoint=t)})).on("dblclick"+this._private.nameSpace,e?".aciTreeLine,.aciTreeItem":".aciTreeItem",this.proxy(function(e){var t=this.itemFrom(e.target);return this.isInode(t)?(this.toggle(t,{collapse:this._instance.options.collapse,expand:this._instance.options.expand,unique:this._instance.options.unique}),!1):void 0})),e?c.addClass(this._instance.jQuery[0],"aciTreeFullRow"):c.removeClass(this._instance.jQuery[0],"aciTreeFullRow")},_multiSelectable:function(e){if(e)this._instance.jQuery.attr("aria-multiselectable",!0);else{var t=this.focused();this._unselect(this.selected().not(t)),this._instance.jQuery.removeAttr("aria-multiselectable")}},_shiftSelect:function(t){var s=this._private.spinPoint;if(s&&e.contains(this._instance.jQuery[0],s[0])&&this.isOpenPath(s)||(s=this.focused()),s.length){var i=[t[0]],n=s[0],c=!1,l=t[0],a=this.visible(this.children(null,!0));a.each(this.proxy(function(t){if(c){if(this.isEnabled(e(t))&&i.push(t),t==n||t==l)return!1}else if(t==n||t==l){if(this.isEnabled(e(t))&&i.push(t),t==n&&t==l)return!1;c=!0}},!0)),this._unselect(this.selected().not(i)),e(i).not(t).each(this.proxy(function(t){var s=e(t);this.isSelected(s)||this.select(s,{focus:!1})},!0))}this._selectOne(t)},_initHook:function(){this.extSelectable()&&this._selectableInit(),this._super()},_itemHook:function(e,t,s,i){this.extSelectable()&&s.selected&&this._selectableDOM.select(t,!0),this._super(e,t,s,i)},_selectableDOM:{select:function(e,t){t?c.addListClass(e.toArray(),"aciTreeSelected",function(e){e.firstChild.setAttribute("aria-selected",!0)}):c.removeListClass(e.toArray(),"aciTreeSelected",function(e){e.firstChild.setAttribute("aria-selected",!1)})},focus:function(e,t){t?(c.addClass(e[0],"aciTreeFocus"),e[0].firstChild.focus()):c.removeListClass(e.toArray(),"aciTreeFocus")}},_selectable:function(t){t?this._instance.jQuery.css({"-webkit-user-select":"text","-moz-user-select":"text","-ms-user-select":"text","-o-user-select":"text","user-select":"text"}).attr({unselectable:null,onselectstart:null}).unbind("selectstart"+this._private.nameSpace):this._instance.jQuery.css({"-webkit-user-select":"none","-moz-user-select":"-moz-none","-ms-user-select":"none","-o-user-select":"none","user-select":"none"}).attr({unselectable:"on",onselectstart:"return false"}).bind("selectstart"+this._private.nameSpace,function(t){return e(t.target).is("input,textarea")?void 0:!1})},_first:function(){return e(c.first(this._instance.jQuery[0],function(e){return this.hasClass(e,"aciTreeVisible")?!0:null}))},_last:function(){return e(c.last(this._instance.jQuery[0],function(e){return this.hasClass(e,"aciTreeVisible")?!0:null}))},_prev:function(t){return e(c.prevAll(t[0],function(e){return this.hasClass(e,"aciTreeVisible")?!0:null}))},_next:function(t){return e(c.nextAll(t[0],function(e){return this.hasClass(e,"aciTreeVisible")?!0:null}))},_prevPage:function(t){for(var s=this._instance.jQuery.height(),i=t[0].firstChild.offsetHeight,n=t,c=e();s>i&&(n=this._prev(n),n[0]);)i+=n[0].firstChild.offsetHeight,c=n;return c},_nextPage:function(t){for(var s=this._instance.jQuery.height(),i=t[0].firstChild.offsetHeight,n=t,c=e();s>i&&(n=this._next(n),n[0]);)i+=n[0].firstChild.offsetHeight,c=n;return c},_selectOne:function(e){this.isSelected(e)?this._focusOne(e):this.isEnabled(e)?this.select(e):this._focusOne(e)},_unselect:function(t){t.each(this.proxy(function(t){this.deselect(e(t))},!0))},_focusOne:function(e){this._instance.options.multiSelectable||this._unselect(this.selected().not(e)),this.isFocused(e)||this.focus(e)},select:function(t,i){if(i=this._options(i,"selected","selectfail","wasselected",t),this.extSelectable()&&this.isItem(t)){if(!this._trigger(t,"beforeselect",i))return void this._fail(t,i);if(i.oldSelected=this.selected(),!this._instance.options.multiSelectable){var n=i.oldSelected.not(t);this._selectableDOM.select(n,!1),n.each(this.proxy(function(t){this._trigger(e(t),"deselected",i)},!0))}this.isSelected(t)?this._notify(t,i):(this._selectableDOM.select(t,!0),this._success(t,i)),(i.focus===s||i.focus)&&(!this.isFocused(t)||i.focus)&&this.focus(t,this._inner(i))}else this._fail(t,i)},deselect:function(e,t){if(t=this._options(t,"deselected","deselectfail","notselected",e),this.extSelectable()&&this.isItem(e)){if(!this._trigger(e,"beforedeselect",t))return void this._fail(e,t);this.isSelected(e)?(this._selectableDOM.select(e,!1),this._success(e,t)):this._notify(e,t)}else this._fail(e,t)},focus:function(t,s){if(s=this._options(s,"focus","focusfail","wasfocused",t),this.extSelectable()&&this.isItem(t)){if(!this._trigger(t,"beforefocus",s))return void this._fail(t,s);s.oldFocused=this.focused();var i=s.oldFocused.not(t);this._selectableDOM.focus(i,!1),i.each(this.proxy(function(t){this._trigger(e(t),"blur",s)},!0)),this.isFocused(t)?this._notify(t,s):(this._selectableDOM.focus(t,!0),this._success(t,s))}else this._fail(t,s)},blur:function(e,t){if(t=this._options(t,"blur","blurfail","notfocused",e),this.extSelectable()&&this.isItem(e)){if(!this._trigger(e,"beforeblur",t))return void this._fail(e,t);this.isFocused(e)?(this._selectableDOM.focus(e,!1),this._success(e,t)):this._notify(e,t)}else this._fail(e,t)},selected:function(){return this._instance.jQuery.find(".aciTreeSelected")},_serialize:function(e,t){var s=this._super(e,t);return s&&this.extSelectable()&&(s.hasOwnProperty("selected")?s.selected=this.isSelected(e):this.isSelected(e)&&(s.selected=!0)),s},isSelected:function(e){return e&&c.hasClass(e[0],"aciTreeSelected")},focused:function(){return this._instance.jQuery.find(".aciTreeFocus")},isFocused:function(e){return e&&c.hasClass(e[0],"aciTreeFocus")},extSelectable:function(){return this._instance.options.selectable},option:function(e,t){this.wasInit()&&!this.isLocked()&&("selectable"==e&&t!=this.extSelectable()&&(t?this._selectableInit():this._selectableDone()),"multiSelectable"==e&&t!=this._instance.options.multiSelectable&&this._multiSelectable(t),"fullRow"==e&&t!=this._instance.options.fullRow&&this._fullRow(t),"textSelection"==e&&t!=this._instance.options.textSelection&&this._selectable(t)),this._super(e,t)},_selectableDone:function(e){if(0==this._instance.jQuery.attr("tabindex")&&this._instance.jQuery.removeAttr("tabindex"),this._instance.options.textSelection||this._selectable(!0),this._instance.jQuery.unbind(this._private.nameSpace),this._instance.jQuery.off(this._private.nameSpace,".aciTreeLine,.aciTreeItem").off(this._private.nameSpace,".aciTreeItem"),c.removeClass(this._instance.jQuery[0],["aciTreeFocus","aciTreeFullRow"]),this._instance.jQuery.removeAttr("aria-multiselectable"),this._instance.focus=!1,this._private.spinPoint=null,!e){this._unselect(this.selected());var t=this.focused();t.length&&this.blur(t)}},_destroyHook:function(e){e&&this._selectableDone(!0),this._super(e)}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(n,"aciTreeSelectable"),aciPluginClass.defaults("aciTree",i);var c=aciPluginClass.plugins.aciTree_dom}(jQuery,this);

// checkbox (works best with selectable)
!function(e,i,t){var c={checkbox:!1,checkboxChain:!0,checkboxBreak:!0,checkboxClick:!1},h={_checkboxInit:function(){this._instance.jQuery.bind("acitree"+this._private.nameSpace,function(e,i,t,c,h){switch(c){case"loaded":i._checkboxLoad(t)}}).bind("keydown"+this._private.nameSpace,this.proxy(function(e){switch(e.which){case 32:if(this.extSelectable&&this.extSelectable()&&!e.ctrlKey){var i=this.focused();this.hasCheckbox(i)&&this.isEnabled(i)&&(this.isChecked(i)?this.uncheck(i):this.check(i),e.stopImmediatePropagation(),e.preventDefault())}}})).on("click"+this._private.nameSpace,".aciTreeItem",this.proxy(function(i){if(!this._instance.options.checkboxClick||e(i.target).is(".aciTreeCheck")){var t=this.itemFrom(i.target);!this.hasCheckbox(t)||!this.isEnabled(t)||this.extSelectable&&this.extSelectable()&&(i.ctrlKey||i.shiftKey)||(this.isChecked(t)?this.uncheck(t):this.check(t),i.preventDefault())}}))},_initHook:function(){this.extCheckbox()&&this._checkboxInit(),this._super()},_itemHook:function(e,i,c,h){if(this.extCheckbox()){var s=this.extRadio&&this.hasRadio(i);s||!c.checkbox&&(c.checkbox!==t||this.extRadio&&this.extRadio())||this._checkboxDOM.add(i,c)}this._super(e,i,c,h)},_checkboxDOM:{add:function(e,t){s.addClass(e[0],t.checked?["aciTreeCheckbox","aciTreeChecked"]:"aciTreeCheckbox");var c=s.childrenByClass(e[0].firstChild,"aciTreeText"),h=c.parentNode,o=i.document.createElement("LABEL"),a=i.document.createElement("SPAN");a.className="aciTreeCheck",o.appendChild(a),o.appendChild(c),h.appendChild(o),e[0].firstChild.setAttribute("aria-checked",!!t.checked)},remove:function(e){s.removeClass(e[0],["aciTreeCheckbox","aciTreeChecked","aciTreeTristate"]);var i=s.childrenByClass(e[0].firstChild,"aciTreeText"),t=i.parentNode,c=t.parentNode;c.replaceChild(i,t),e[0].firstChild.removeAttribute("aria-checked")},check:function(e,i){s.toggleListClass(e.toArray(),"aciTreeChecked",i,function(e){e.firstChild.setAttribute("aria-checked",i)})},tristate:function(e,i){s.toggleListClass(e.toArray(),"aciTreeTristate",i)}},_checkboxLoad:function(e){if(this._instance.options.checkboxChain!==!1){var i=t;this.hasCheckbox(e)&&(this.isChecked(e)?this.checkboxes(this.children(e,!1,!0),!0).length||(i=!0):i=!1),this._checkboxUpdate(e,i)}},_checkboxChildren:function(i){if(this._instance.options.checkboxBreak){var t=[],c=this.proxy(function(i){var h=this.children(i,!1,!0);h.each(this.proxy(function(i){var h=e(i);this.hasCheckbox(h)&&(t.push(i),c(h))},!0))});return c(i),e(t)}var h=this.children(i,!0,!0);return this.checkboxes(h)},_checkboxUpdate:function(i,c){var h=this.proxy(function(i,c,s){var o=this.children(i,!1,!0),a=0,n=0;o.each(this.proxy(function(i){var c=e(i),o={total:0,checked:0};if(this.hasCheckbox(c))s!==t&&-1!==this._instance.options.checkboxChain&&this._checkboxDOM.check(c,s),a++,this.isChecked(c)&&n++,h(c,o,s);else if(this._instance.options.checkboxBreak){var r={total:0,checked:0};h(c,r)}else h(c,o,s);a+=o.total,n+=o.checked},!0)),i&&(this._checkboxDOM.tristate(i,n>0&&n!=a),c.total+=a,c.checked+=n)}),s={total:0,checked:0};h(i,s,c);var o=this.proxy(function(e,i,c){var h=this.parent(e);if(h.length){if(!i)var s=this._checkboxChildren(h),a=this.checkboxes(s,!0).length,i=a>0&&a!=s.length;this.hasCheckbox(h)?(c!==t&&1!==this._instance.options.checkboxChain&&this._checkboxDOM.check(h,i?!0:c),this._checkboxDOM.tristate(h,i),o(h,i,c)):this._instance.options.checkboxBreak?o(h):o(h,i,c)}});o(i,t,c)},hasCheckbox:function(e){return e&&s.hasClass(e[0],"aciTreeCheckbox")},addCheckbox:function(e,i){if(i=this._options(i,"checkboxadded","addcheckboxfail","wascheckbox",e),this.isItem(e)){if(!this._trigger(e,"beforeaddcheckbox",i))return void this._fail(e,i);if(this.hasCheckbox(e))this._notify(e,i);else{var t=function(){this._checkboxDOM.add(e,{}),this._success(e,i)};this.extRadio&&this.hasRadio(e)?this.removeRadio(e,this._inner(i,{success:t,fail:i.fail})):t.apply(this)}}else this._fail(e,i)},removeCheckbox:function(e,i){if(i=this._options(i,"checkboxremoved","removecheckboxfail","notcheckbox",e),this.isItem(e)){if(!this._trigger(e,"beforeremovecheckbox",i))return void this._fail(e,i);this.hasCheckbox(e)?(this._checkboxDOM.remove(e),this._success(e,i)):this._notify(e,i)}else this._fail(e,i)},isChecked:function(e){return this.hasCheckbox(e)?s.hasClass(e[0],"aciTreeChecked"):this._super?this._super(e):!1},check:function(e,i){if(this.extCheckbox&&this.hasCheckbox(e)){if(i=this._options(i,"checked","checkfail","waschecked",e),!this._trigger(e,"beforecheck",i))return void this._fail(e,i);this.isChecked(e)?this._notify(e,i):(this._checkboxDOM.check(e,!0),this._instance.options.checkboxChain!==!1&&this._checkboxUpdate(e,!0),this._success(e,i))}else this._super?this._super(e,i):(this._trigger(e,"checkfail",i),this._fail(e,i))},uncheck:function(e,i){if(this.extCheckbox&&this.hasCheckbox(e)){if(i=this._options(i,"unchecked","uncheckfail","notchecked",e),!this._trigger(e,"beforeuncheck",i))return void this._fail(e,i);this.isChecked(e)?(this._checkboxDOM.check(e,!1),this._instance.options.checkboxChain!==!1&&this._checkboxUpdate(e,!1),this._success(e,i)):this._notify(e,i)}else this._super?this._super(e,i):(this._trigger(e,"uncheckfail",i),this._fail(e,i))},checkboxes:function(i,c){return e(c!==t?s.withClass(i.toArray(),c?["aciTreeCheckbox","aciTreeChecked"]:"aciTreeCheckbox",c?null:"aciTreeChecked"):s.withClass(i.toArray(),"aciTreeCheckbox"))},_serialize:function(e,i){var t=this._super(e,i);return t&&this.extCheckbox()&&(t.hasOwnProperty("checkbox")?(t.checkbox=this.hasCheckbox(e),t.checked=this.isChecked(e)):this.hasCheckbox(e)&&(this.extRadio&&this.extRadio()&&(t.checkbox=!0),t.checked=this.isChecked(e))),t},serialize:function(i,t,c){if("checkbox"==t){var h="",s=this.children(i,!0,!0);return this.checkboxes(s,!0).each(this.proxy(function(i){var s=e(i);h+=c?c.call(this,s,t,this.getId(s)):this._instance.options.serialize.call(this,s,t,this.getId(s))},!0)),h}return this._super(i,t,c)},isTristate:function(e){return e&&s.hasClass(e[0],"aciTreeTristate")},tristate:function(i){return e(s.withClass(i.toArray(),"aciTreeTristate"))},extCheckbox:function(){return this._instance.options.checkbox},option:function(e,i){this.wasInit()&&!this.isLocked()&&"checkbox"==e&&i!=this.extCheckbox()&&(i?this._checkboxInit():this._checkboxDone()),this._super(e,i)},_checkboxDone:function(i){this._instance.jQuery.unbind(this._private.nameSpace),this._instance.jQuery.off(this._private.nameSpace,".aciTreeItem"),i||this.checkboxes(this.children(null,!0,!0)).each(this.proxy(function(i){this.removeCheckbox(e(i))},!0))},_destroyHook:function(e){e&&this._checkboxDone(!0),this._super(e)}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(h,"aciTreeCheckbox"),aciPluginClass.defaults("aciTree",c);var s=aciPluginClass.plugins.aciTree_dom}(jQuery,this);

// radio (works best with selectable)
!function(i,e,t){var s={radio:!1,radioChain:!0,radioBreak:!0,radioClick:!1},a={_radioInit:function(){this._instance.jQuery.bind("acitree"+this._private.nameSpace,function(i,e,t,s,a){switch(s){case"loaded":t&&e._radioLoad(t)}}).bind("keydown"+this._private.nameSpace,this.proxy(function(i){switch(i.which){case 32:if(this.extSelectable&&this.extSelectable()&&!i.ctrlKey){var e=this.focused();this.hasRadio(e)&&this.isEnabled(e)&&(this.isChecked(e)||this.check(e),i.stopImmediatePropagation(),i.preventDefault())}}})).on("click"+this._private.nameSpace,".aciTreeItem",this.proxy(function(e){if(!this._instance.options.radioClick||i(e.target).is(".aciTreeCheck")){var t=this.itemFrom(e.target);!this.hasRadio(t)||!this.isEnabled(t)||this.extSelectable&&this.extSelectable()&&(e.ctrlKey||e.shiftKey)||(this.isChecked(t)||this.check(t),e.preventDefault())}}))},_initHook:function(){this.extRadio()&&this._radioInit(),this._super()},_itemHook:function(i,e,s,a){if(this.extRadio()){var h=this.extCheckbox&&this.hasCheckbox(e);h||!s.radio&&(s.radio!==t||this.extCheckbox&&this.extCheckbox())||this._radioDOM.add(e,s)}this._super(i,e,s,a)},_radioDOM:{add:function(i,t){h.addClass(i[0],t.checked?["aciTreeRadio","aciTreeChecked"]:"aciTreeRadio");var s=h.childrenByClass(i[0].firstChild,"aciTreeText"),a=s.parentNode,r=e.document.createElement("LABEL"),o=e.document.createElement("SPAN");o.className="aciTreeCheck",r.appendChild(o),r.appendChild(s),a.appendChild(r),i[0].firstChild.setAttribute("aria-checked",!!t.checked)},remove:function(i){h.removeClass(i[0],["aciTreeRadio","aciTreeChecked"]);var e=h.childrenByClass(i[0].firstChild,"aciTreeText"),t=e.parentNode,s=t.parentNode;s.replaceChild(e,t),i[0].firstChild.removeAttribute("aria-checked")},check:function(i,e){h.toggleListClass(i.toArray(),"aciTreeChecked",e,function(i){i.firstChild.setAttribute("aria-checked",e)})}},_radioLoad:function(i){this._instance.options.radioChain&&this.hasRadio(i)&&(this.isChecked(i)?this.radios(this.children(i,!1,!0),!0).length||this._radioUpdate(i,!0):this._radioUpdate(i))},_radioChildren:function(e){if(this._instance.options.radioBreak){var t=[],s=this.proxy(function(e){var a=this.children(e,!1,!0);a.each(this.proxy(function(e){var a=i(e);this.hasRadio(a)&&(t.push(e),s(a))},!0))});return s(e),i(t)}var a=this.children(e,!0,!0);return this.radios(a)},_radioLevel:function(e){var t=[];return e.each(this.proxy(function(e){var s=i(e),a=this.children(s,!1,!0);a.each(this.proxy(function(e){var s=i(e);(!this._instance.options.radioBreak||this.hasRadio(s))&&t.push(e)},!0))},!0)),i(t)},_radioUpdate:function(e,s){var a=this.proxy(function(e){var t=this.siblings(e,!0);this._radioDOM.check(this.radios(t),!1),t.each(this.proxy(function(e){var t=i(e);(!this._instance.options.radioBreak||this.hasRadio(t))&&this._radioDOM.check(this._radioChildren(t),!1)},!0))});s&&a(e);var h=this.proxy(function(i){var e=this._radioLevel(i),t=this.radios(e);if(t.length){var s=this.radios(e,!0);s.length?(s=s.first(),this._radioDOM.check(s,!0),a(s),h(s)):(s=t.first(),this._radioDOM.check(s,!0),a(s),h(s))}else e.length&&h(e)});s?h(e):this._radioDOM.check(this._radioChildren(e),!1);var r=this.proxy(function(i){var e=this.parent(i);e.length&&(this.hasRadio(e)?(s&&a(e),this._radioDOM.check(e,s),r(e)):this._instance.options.radioBreak||(s&&a(e),r(e)))});s!==t&&r(e)},hasRadio:function(i){return i&&h.hasClass(i[0],"aciTreeRadio")},addRadio:function(i,e){if(e=this._options(e,"radioadded","addradiofail","wasradio",i),this.isItem(i)){if(!this._trigger(i,"beforeaddradio",e))return void this._fail(i,e);if(this.hasRadio(i))this._notify(i,e);else{var t=function(){this._radioDOM.add(i,{}),this._success(i,e)};this.extCheckbox&&this.hasCheckbox(i)?this.removeCheckbox(i,this._inner(e,{success:t,fail:e.fail})):t.apply(this)}}else this._fail(i,e)},removeRadio:function(i,e){if(e=this._options(e,"radioremoved","removeradiofail","notradio",i),this.isItem(i)){if(!this._trigger(i,"beforeremoveradio",e))return void this._fail(i,e);this.hasRadio(i)?(this._radioDOM.remove(i),this._success(i,e)):this._notify(i,e)}else this._fail(i,e)},isChecked:function(i){return this.hasRadio(i)?h.hasClass(i[0],"aciTreeChecked"):this._super?this._super(i):!1},check:function(i,e){if(this.extRadio&&this.hasRadio(i)){if(e=this._options(e,"checked","checkfail","waschecked",i),!this._trigger(i,"beforecheck",e))return void this._fail(i,e);this.isChecked(i)?this._notify(i,e):(this._radioDOM.check(i,!0),this._instance.options.radioChain&&this._radioUpdate(i,!0),this._success(i,e))}else this._super?this._super(i,e):(this._trigger(i,"checkfail",e),this._fail(i,e))},uncheck:function(i,e){if(this.extRadio&&this.hasRadio(i)){if(e=this._options(e,"unchecked","uncheckfail","notchecked",i),!this._trigger(i,"beforeuncheck",e))return void this._fail(i,e);this.isChecked(i)?(this._radioDOM.check(i,!1),this._instance.options.radioChain&&this._radioUpdate(i,!1),this._success(i,e)):this._notify(i,e)}else this._super?this._super(i,e):(this._trigger(i,"uncheckfail",e),this._fail(i,e))},radios:function(e,s){return i(s!==t?h.withClass(e.toArray(),s?["aciTreeRadio","aciTreeChecked"]:"aciTreeRadio",s?null:"aciTreeChecked"):h.withClass(e.toArray(),"aciTreeRadio"))},_serialize:function(i,e){var t=this._super(i,e);return t&&this.extRadio()&&(t.hasOwnProperty("radio")?(t.radio=this.hasRadio(i),t.checked=this.isChecked(i)):this.hasRadio(i)&&(this.extCheckbox&&this.extCheckbox()&&(t.radio=!0),t.checked=this.isChecked(i))),t},serialize:function(e,t,s){if("radio"==t){var a="",h=this.children(e,!0,!0);return this.radios(h,!0).each(this.proxy(function(e){var h=i(e);a+=s?s.call(this,h,t,this.getId(h)):this._instance.options.serialize.call(this,h,t,this.getId(h))},!0)),a}return this._super(e,t,s)},extRadio:function(){return this._instance.options.radio},option:function(i,e){this.wasInit()&&!this.isLocked()&&"radio"==i&&e!=this.extRadio()&&(e?this._radioInit():this._radioDone()),this._super(i,e)},_radioDone:function(e){this._instance.jQuery.unbind(this._private.nameSpace),this._instance.jQuery.off(this._private.nameSpace,".aciTreeItem"),e||this.radios(this.children(null,!0,!0)).each(this.proxy(function(e){this.removeRadio(i(e))},!0))},_destroyHook:function(i){i&&this._radioDone(!0),this._super(i)}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(a,"aciTreeRadio"),aciPluginClass.defaults("aciTree",s);var h=aciPluginClass.plugins.aciTree_dom}(jQuery,this);

// column
!function(i,e,t){var n={columnData:[]},s={__extend:function(){i.extend(this._private,{propsIndex:{}}),this._super()},_initHook:function(){if(this._instance.options.columnData.length){var i,e=!1;for(var n in this._instance.options.columnData)i=this._instance.options.columnData[n],i.width!==t&&(this._updateCss(".aciTree.aciTree"+this._instance.index+" .aciTreeColumn"+n,"width:"+i.width+"px;"),e=!0),this._private.propsIndex[i.props]=n;e&&this._updateWidth()}this._super()},_getCss:function(t,n,s){var a="_getCss_"+e.String(t).replace(/[^a-z0-9_-]/gi,"_"),r=i("body").find("#"+a);if(!r.length){if(t instanceof Array){var o="",c="";for(var l in t)o+='<div class="'+t[l]+'">',c+="</div>";o+=c}else var o='<div class="'+t+'"></div>';i("body").append('<div id="'+a+'" style="position:relative;display:inline-block;width:0px;height:0px;line-height:0px;overflow:hidden">'+o+"</div>"),r=i("body").find("#"+a)}var u=r.find("*:last").css(n);return s&&(u=parseInt(u),isNaN(u)&&(u=null)),u},_updateCss:function(t,n){var s="_updateCss_"+e.String(t).replace(">","_gt_").replace(/[^a-z0-9_-]/gi,"_"),a='<style id="'+s+'" type="text/css">'+t+"{"+n+"}</style>",r=i("body").find("#"+s);r.length?r.replaceWith(a):i("body").prepend(a)},getWidth:function(i){return i>=0&&i<this.columns()?this._getCss(["aciTree aciTree"+this._instance.index,"aciTreeColumn"+i],"width",!0):null},setWidth:function(i,e){i>=0&&i<this.columns()&&(this._updateCss(".aciTree.aciTree"+this._instance.index+" .aciTreeColumn"+i,"width:"+e+"px;"),this._updateWidth())},_updateWidth:function(){var i=0;for(var e in this._instance.options.columnData)this.isColumn(e)&&(i+=this.getWidth(e));var t=this._getCss(["aciTree","aciTreeIcon"],"width",!0);i+=this._getCss(["aciTree","aciTreeItem"],"padding-left",!0)+this._getCss(["aciTree","aciTreeItem"],"padding-right",!0),this._updateCss(".aciTree.aciTree"+this._instance.index+" .aciTreeItem","margin-right:"+(t+i)+"px;"),this._updateCss(".aciTree[dir=rtl].aciTree"+this._instance.index+" .aciTreeItem","margin-right:0;margin-left:"+(t+i)+"px;")},isColumn:function(i){return i>=0&&i<this.columns()?"none"!=this._getCss(["aciTree aciTree"+this._instance.index,"aciTreeColumn"+i],"display"):!1},columnIndex:function(i){return this._private.propsIndex[i]!==t?this._private.propsIndex[i]:-1},columns:function(){return this._instance.options.columnData.length},toggleColumn:function(i,e){if(i>=0&&i<this.columns()){if(e===t)var e=!this.isColumn(i);this._updateCss(".aciTree.aciTree"+this._instance.index+" .aciTreeColumn"+i,"display:"+(e?"inherit":"none")+";"),this._updateWidth()}},_itemHook:function(i,e,t,n){if(this.columns()){var s,r,o=a.childrenByClass(e[0].firstChild,"aciTreeEntry");for(var c in this._instance.options.columnData)s=this._instance.options.columnData[c],r=this._createColumn(t,s,c),o.insertBefore(r,o.firstChild)}this._super(i,e,t,n)},_createColumn:function(i,n,s){var a=n.props&&i[n.props]!==t?i[n.props]:n.value===t?"":n.value,r=e.document.createElement("DIV");return r.className="aciTreeColumn aciTreeColumn"+s,r.innerHTML=a.length?a:"&nbsp;",r},setColumn:function(i,e){if(e=this._options(e,"columnset","columnfail","wascolumn",i),this.isItem(i)&&e.index>=0&&e.index<this.columns()){if(!this._trigger(i,"beforecolumn",e))return void this._fail(i,e);var t=this.itemData(i);e.oldValue=t[this._instance.options.columnData[e.index].props],e.value==e.oldValue?this._notify(i,e):(i.children(".aciTreeLine").find(".aciTreeColumn"+e.index).html(e.value),t[this._instance.options.columnData[e.index].props]=e.value,this._success(i,e))}else this._fail(i,e)},getColumn:function(i,e){if(e>=0&&e<this.columns()){var t=this.itemData(i);return t?t[this._instance.options.columnData[e].props]:null}return null}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(s,"aciTreeColumn"),aciPluginClass.defaults("aciTree",n);var a=aciPluginClass.plugins.aciTree_dom}(jQuery,this);

// editable (works best with selectable)
!function(e,t,i){var s={editable:!1,editDelay:250},a={__extend:function(){e.extend(this._private,{editTimestamp:null}),this._super()},_editableInit:function(){this._instance.jQuery.bind("acitree"+this._private.nameSpace,function(e,t,i,s,a){switch(s){case"blurred":var i=t.edited();i.length&&t.endEdit();break;case"deselected":t.isEdited(i)&&t.endEdit()}}).bind("click"+this._private.nameSpace,this.proxy(function(){var e=this.edited();e.length&&this.endEdit()})).bind("keydown"+this._private.nameSpace,this.proxy(function(e){switch(e.which){case 113:if(this.extSelectable&&this.extSelectable()){var t=this.focused();t.length&&!this.isEdited(t)&&this.isEnabled(t)&&(this.edit(t),e.preventDefault())}}})).on("mousedown"+this._private.nameSpace,".aciTreeItem",this.proxy(function(t){e(t.target).is(".aciTreeItem,.aciTreeText")&&(this._private.editTimestamp=e.now())})).on("mouseup"+this._private.nameSpace,".aciTreeItem",this.proxy(function(t){if(e(t.target).is(".aciTreeItem,.aciTreeText")){var i=e.now()-this._private.editTimestamp;if(i>this._instance.options.editDelay&&i<4*this._instance.options.editDelay){var s=this.itemFrom(t.target);(!this.extSelectable||!this.extSelectable()||this.isFocused(s)&&1==this.selected().length)&&this.isEnabled(s)&&this.edit(s)}}})).on("keydown"+this._private.nameSpace,"input[type=text]",this.proxy(function(e){switch(e.which){case 13:this.itemFrom(e.target).focus(),this.endEdit(),e.stopPropagation();break;case 27:this.itemFrom(e.target).focus(),this.endEdit({save:!1}),e.stopPropagation(),e.preventDefault();break;case 38:case 40:case 37:case 39:case 33:case 34:case 36:case 35:case 32:case 107:case 109:case 106:e.stopPropagation()}})).on("blur"+this._private.nameSpace,"input[type=text]",this.proxy(function(){this.extSelectable&&this.extSelectable()||this.endEdit()})).on("click"+this._private.nameSpace+" dblclick"+this._private.nameSpace,"input[type=text]",function(e){e.stopPropagation()})},_initHook:function(){this.extEditable()&&this._editableInit(),this._super()},_editableDOM:{add:function(e){var t=e.addClass("aciTreeEdited").children(".aciTreeLine");t.find(".aciTreeText").html('<input id="aciTree-editable-tree-item" type="text" value="" style="-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;-o-user-select:text;user-select:text" />'),t.find("label").attr("for","aciTree-editable-tree-item"),this._editableDOM.get(e).val(this.getLabel(e))},remove:function(e,t){var i=e.removeClass("aciTreeEdited").children(".aciTreeLine");i.find(".aciTreeText").html(this.getLabel(e)),i.find("label").removeAttr("for")},get:function(t){return t?t.children(".aciTreeLine").find("input[type=text]"):e([])}},edited:function(){return this._instance.jQuery.find(".aciTreeEdited")},isEdited:function(e){return e&&n.hasClass(e[0],"aciTreeEdited")},_focusEdit:function(e){var t=this._editableDOM.get(e).focus().trigger("click")[0];if(t)if("number"==typeof t.selectionStart)t.selectionStart=t.selectionEnd=t.value.length;else if(t.createTextRange!==i){var s=t.createTextRange();s.collapse(!1),s.select()}},setLabel:function(e,t){this.extEditable()&&this.isEdited(e)||this._super(e,t)},edit:function(e,t){if(t=this._options(t,"edit","editfail","wasedit",e),this.extEditable()&&this.isItem(e)){if(!this._trigger(e,"beforeedit",t))return void this._fail(e,t);var i=this.edited();if(i.length){if(i[0]==e[0])return void this._notify(e,t);this._editableDOM.remove.call(this,i),this._trigger(i,"endedit",t)}this._editableDOM.add.call(this,e),this._focusEdit(e),this._success(e,t)}else this._fail(e,t)},endEdit:function(e){var t=this.edited();if(e=this._options(e,"edited","endeditfail","endedit",t),this.extEditable()&&this.isItem(t)){if(!this._trigger(t,"beforeendedit",e))return void this._fail(t,e);var s=this._editableDOM.get(t).val();this._editableDOM.remove.call(this,t),e.save===i||e.save?(this.setLabel(t,{label:s}),this._success(t,e)):this._notify(t,e)}else this._fail(t,e)},extEditable:function(){return this._instance.options.editable},option:function(e,t){this.wasInit()&&!this.isLocked()&&"editable"==e&&t!=this.extEditable()&&(t?this._editableInit():this._editableDone()),this._super(e,t)},_editableDone:function(){this._instance.jQuery.unbind(this._private.nameSpace),this._instance.jQuery.off(this._private.nameSpace,".aciTreeItem"),this._instance.jQuery.off(this._private.nameSpace,"input[type=text]");var e=this.edited();e.length&&this.endEdit()},_destroyHook:function(e){e&&this._editableDone(),this._super(e)}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(a,"aciTreeEditable"),aciPluginClass.defaults("aciTree",s);var n=aciPluginClass.plugins.aciTree_dom}(jQuery,this);

// persist (require utils extension & jStorage plugin)
!function(e,t,s){var i={persist:null},n={__extend:function(){e.extend(this._private,{selectTimeout:null,focusTimeout:null,openTimeout:null}),this._super()},_initPersist:function(){this._instance.jQuery.bind("acitree"+this._private.nameSpace,function(e,t,s,i,n){if("ui.persist"!=n.uid)switch(i){case"init":t._persistRestore();break;case"selected":case"deselected":t._persistLater("selected");break;case"focus":case"blur":t._persistLater("focused");break;case"opened":case"closed":t._persistLater("opened")}})},_initHook:function(){this.extPersist()&&this._initPersist(),this._super()},_persistLater:function(e){switch(e){case"selected":t.clearTimeout(this._private.selectTimeout),this._private.selectTimeout=t.setTimeout(this.proxy(function(){this._persistSelected()}),250);break;case"focused":t.clearTimeout(this._private.focusTimeout),this._private.focusTimeout=t.setTimeout(this.proxy(function(){this._persistFocused()}),250);break;case"opened":t.clearTimeout(this._private.openTimeout),this._private.openTimeout=t.setTimeout(this.proxy(function(){this._persistOpened()}),250)}},_persistRestore:function(){var t=new this._queue(this,this._instance.options.queue),s=new this._task(t,function(s){if(this.extSelectable&&this.extSelectable()){var i=e.jStorage.get("aciTree_"+this._instance.options.persist+"_selected");if(i instanceof Array)for(var n in i)if(function(e){t.push(function(t){this.searchPath(null,{success:function(e){this.select(e,{uid:"ui.persist",success:function(){t()},fail:t,focus:!1})},fail:t,path:e.split(";")})})}(i[n]),!this._instance.options.multiSelectable)break;var r=e.jStorage.get("aciTree_"+this._instance.options.persist+"_focused");if(r instanceof Array)for(var n in r)!function(e){t.push(function(t){this.searchPath(null,{success:function(e){this.focus(e,{uid:"ui.persist",success:function(e){this.setVisible(e,{center:!0}),t()},fail:t})},fail:t,path:e.split(";")})})}(r[n])}s()}),i=e.jStorage.get("aciTree_"+this._instance.options.persist+"_opened");if(i instanceof Array)for(var n in i)!function(e){s.push(function(t){this.searchPath(null,{success:function(e){this.open(e,{uid:"ui.persist",success:t,fail:t})},fail:t,path:e.split(";"),load:!0})})}(i[n])},_persistSelected:function(){if(this.extSelectable&&this.extSelectable()){var t=[];this.selected().each(this.proxy(function(s){var i=e(s),n=this.pathId(i);n.push(this.getId(i)),t.push(n.join(";"))},!0)),e.jStorage.set("aciTree_"+this._instance.options.persist+"_selected",t)}},_persistFocused:function(){if(this.extSelectable&&this.extSelectable()){var t=[];this.focused().each(this.proxy(function(s){var i=e(s),n=this.pathId(i);n.push(this.getId(i)),t.push(n.join(";"))},!0)),e.jStorage.set("aciTree_"+this._instance.options.persist+"_focused",t)}},_persistOpened:function(){var t=[];this.inodes(this.children(null,!0),!0).each(this.proxy(function(s){var i=e(s);if(this.isOpenPath(i)){var n=this.pathId(i);n.push(this.getId(i)),t.push(n.join(";"))}},!0)),e.jStorage.set("aciTree_"+this._instance.options.persist+"_opened",t)},isPersist:function(){if(this.extPersist()){var t=e.jStorage.get("aciTree_"+this._instance.options.persist+"_selected");if(t instanceof Array)return!0;var s=e.jStorage.get("aciTree_"+this._instance.options.persist+"_focused");if(s instanceof Array)return!0;var i=e.jStorage.get("aciTree_"+this._instance.options.persist+"_opened");if(i instanceof Array)return!0}return!1},unpersist:function(){this.extPersist()&&(e.jStorage.deleteKey("aciTree_"+this._instance.options.persist+"_selected"),e.jStorage.deleteKey("aciTree_"+this._instance.options.persist+"_focused"),e.jStorage.deleteKey("aciTree_"+this._instance.options.persist+"_opened"))},extPersist:function(){return this._instance.options.persist},option:function(e,t){var s=this.extPersist();this._super(e,t),this.extPersist()!=s&&(s?this._donePersist():this._initPersist())},_donePersist:function(){this._instance.jQuery.unbind(this._private.nameSpace)},_destroyHook:function(e){e&&this._donePersist(),this._super(e)}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(n,"aciTreePersist"),aciPluginClass.defaults("aciTree",i)}(jQuery,this);

// hash (require utils extension & aciFragment plugin)
!function(t,i,s){var e={selectHash:null,openHash:null},n={__extend:function(){t.extend(this._private,{lastSelect:null,lastOpen:null,hashApi:null}),this._super()},_hashInit:function(){this._instance.jQuery.aciFragment(),this._private.hashApi=this._instance.jQuery.aciFragment("api"),this._instance.jQuery.bind("acitree"+this._private.nameSpace,function(t,i,s,e,n){switch(e){case"init":i._hashRestore()}}).bind("acifragment"+this._private.nameSpace,this.proxy(function(t,i,s){t.stopPropagation(),this._hashRestore()}))},_initHook:function(){this.extHast()&&this._hashInit(),this._super()},_hashRestore:function(){var t=this._instance.queue,i=function(i){for(var s in i)!function(i){t.push(function(t){this.search(null,{success:function(i){this.open(i,{uid:"ui.hash",success:t,fail:t})},fail:t,search:i})})}(i[s])};if(this._instance.options.openHash){var s=this._private.hashApi.get(this._instance.options.openHash,"");if(s.length&&s!=this._private.lastOpen){this._private.lastOpen=s;var e=s.split(";");i(e)}}if(this._instance.options.selectHash&&this.extSelectable&&this.extSelectable()){var s=this._private.hashApi.get(this._instance.options.selectHash,"");if(s.length&&s!=this._private.lastSelect){this._private.lastSelect=s;var e=s.split(";"),n=e.pop();i(e),n&&t.push(function(t){this.search(null,{success:function(i){this.select(i,{uid:"ui.hash",success:function(i){this.setVisible(i,{center:!0}),t()},fail:t})},fail:t,search:n})})}}},extHast:function(){return this._instance.options.selectHash||this._instance.options.openHash},option:function(t,i){var s=this.extHast();this._super(t,i),this.extHast()!=s&&(s?this._hashDone():this._hashInit())},_hashDone:function(){this._instance.jQuery.unbind(this._private.nameSpace),this._private.hashApi=null,this._instance.jQuery.aciFragment("destroy")},_destroyHook:function(t){t&&this._hashDone(),this._super(t)}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(n,"aciTreeHash"),aciPluginClass.defaults("aciTree",e)}(jQuery,this);

// sortable (require utils extension & aciSortable plugin)
!function(e,t,i){var r={sortable:!1,sortDelay:750,sortDrag:function(e,t,i,r){if(!i){var s=this.getLabel(e);this._private.dragDrop&&this._private.dragDrop.length>1&&(s+=" and #"+(this._private.dragDrop.length-1)+" more"),r.html(s)}},sortValid:function(e,t,i,r,s,a){var n=this.getLabel(e);this._private.dragDrop.length>1&&(n+=" and #"+(this._private.dragDrop.length-1)+" more"),r?(a.html("move "+n+" to "+this.getLabel(this.itemFrom(t))),s.removeClass("aciTreeAfter aciTreeBefore")):null!==i&&(i?(a.html("move "+n+" before "+this.getLabel(t)),s.removeClass("aciTreeAfter").addClass("aciTreeBefore")):(a.html("move "+n+" after "+this.getLabel(t)),s.removeClass("aciTreeBefore").addClass("aciTreeAfter")))},sortOptions:{}},s={__extend:function(){e.extend(this._private,{openTimeout:null,dragDrop:null,sortableApi:null}),this._super()},_sortableInit:function(){this._instance.jQuery.aciSortable(e.extend({container:".aciTreeUl",item:".aciTreeLi",child:50,childHolder:'<ul class="aciTreeUl aciTreeChild"></ul>',childHolderSelector:".aciTreeChild",placeholder:'<li class="aciTreeLi aciTreePlaceholder"><div></div></li>',placeholderSelector:".aciTreePlaceholder",helper:'<div class="aciTreeHelper"></div>',helperSelector:".aciTreeHelper",before:this.proxy(function(e){if(!this._initDrag(e))return!1;var t={items:this._private.dragDrop};return this._trigger(e,"beforedrag",t)?!0:(this._trigger(e,"dragfail",t),!1)}),start:this.proxy(function(e,t,i){this._instance.jQuery.addClass("aciTreeDragDrop"),i.css({opacity:1}).html(this.getLabel(e))}),drag:this.proxy(function(e,t,i,r){this._instance.options.sortDrag&&this._instance.options.sortDrag.apply(this,arguments)}),valid:this.proxy(function(e,i,r,s,a,n){if(t.clearTimeout(this._private.openTimeout),!this._checkDrop(e,i,r,s,a,n))return!1;this.isInode(i)&&!this.isOpen(i)&&(this._private.openTimeout=t.setTimeout(this.proxy(function(){this.open(i)}),this._instance.options.sortDelay));var o=this._options({items:this._private.dragDrop,hover:i,before:r,isContainer:s,placeholder:a,helper:n});return this._trigger(e,"checkdrop",o)?(this._instance.options.sortValid&&this._instance.options.sortValid.apply(this,arguments),!0):!1}),create:this.proxy(function(e,t,i){return this.isLeaf(i)?(i.append(e._instance.options.childHolder),!0):!1},!0),end:this.proxy(function(i,r,s,a){t.clearTimeout(this._private.openTimeout);var n={items:this._private.dragDrop,placeholder:s,helper:a};if(n=this._options(n,"sorted","dropfail",null,i),s.parent().length){var o=this.prev(s,!0);if(o.length){s.detach();var h=e(this._private.dragDrop.get().reverse());this._private.dragDrop=null,h.each(this.proxy(function(t){this.moveAfter(e(t),this._inner(n,{success:n.success,fail:n.fail,after:o}))},!0))}else{var l=this.next(s,!0);if(l.length){s.detach();var h=e(this._private.dragDrop.get().reverse());this._private.dragDrop=null,h.each(this.proxy(function(t){this.moveBefore(e(t),this._inner(n,{success:n.success,fail:n.fail,before:l}))},!0))}else{var c=this.parent(s),p=s.parent();if(s.detach(),p.remove(),this.isLeaf(c)){var h=this._private.dragDrop;this.asChild(h.eq(0),this._inner(n,{success:function(){this._success(i,n),this.open(c),h.filter(":gt(0)").each(this.proxy(function(t){this.moveAfter(e(t),this._inner(n,{success:n.success,fail:n.fail,after:this.last(c)}))},!0))},fail:n.fail,parent:c}))}else this._fail(i,n)}}if(this.extSelectable&&this.extSelectable()){var u=this.focused();u.length&&u[0].firstChild.focus()}}else this._fail(i,n);if(this._private.dragDrop=null,a.parent().length){var f=e(t).scrollTop(),d=e(t).scrollLeft(),_=i[0].getBoundingClientRect();a.animate({top:_.top+f,left:_.left+d,opacity:0},{complete:function(){a.detach()}})}this._instance.jQuery.removeClass("aciTreeDragDrop")})},this._instance.options.sortOptions)),this._private.sortableApi=this._instance.jQuery.aciSortable("api"),this._instance.jQuery.bind("keydown"+this._private.nameSpace,this.proxy(function(e){switch(e.which){case 27:this._private.sortableApi.cancel()}}))},_initHook:function(){this.extSortable()&&this._sortableInit(),this._super()},_parents:function(e){for(var t,i,r=e.length,s=[],a=0;r-1>a;a++){t=e.eq(a);for(var n=a+1;r>n;n++)i=e.eq(n),this.isChildren(t,i)?s.push(e[n]):this.isChildren(i,t)&&s.push(e[a])}return e.not(s)},_initDrag:function(e){if(this.extSelectable&&this.extSelectable()){if(this.hasFocus()||this._instance.jQuery.focus(),!this.isEnabled(e))return!1;var t=this.selected();if(t.length){if(!this.isSelected(e))return!1}else t=e;this._private.dragDrop=this._parents(t)}else this._instance.jQuery.focus(),this._private.dragDrop=e;return!0},_checkDrop:function(e,t,i,r,s,a){var n=this._private.dragDrop;if(!n)return!1;var o=this.itemFrom(t);return n.is(o)||n.has(o[0]).length?!1:!r&&(o=i?this.prev(t):this.next(t),n.is(o))?!1:!0},extSortable:function(){return this._instance.options.sortable},option:function(e,t){this.wasInit()&&!this.isLocked()&&"sortable"==e&&t!=this.extSortable()&&(t?this._sortableInit():this._sortableDone()),this._super(e,t)},_sortableDone:function(){this._instance.jQuery.unbind(this._private.nameSpace),this._private.sortableApi=null,this._instance.jQuery.aciSortable("destroy")},_destroyHook:function(e){e&&this._sortableDone(),this._super(e)}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(s,"aciTreeSortable"),aciPluginClass.defaults("aciTree",r)}(jQuery,this);
